<html>
<head>
<title></title>
<link rel="stylesheet" href="gemTemplate.css">
</head>
<body>
<div id="content">
<p id="polarion_1">
 <br/>
</p>
<p id="polarion_2">
 <br/>
</p>
<p id="polarion_3">
 <br/>
</p>
<p id="polarion_4">
 <br/>
</p>
<p id="polarion_5">
 <br/>
</p>
<p id="polarion_6">
 <span style="font-weight: bold;text-decoration: underline;font-size: 12pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">
  Elektronische Gesundheitskarte und Telematikinfrastruktur
 </span>
</p>
<p id="polarion_7">
 <br/>
</p>
<p id="polarion_8">
 <br/>
</p>
<p id="polarion_9">
 <br/>
</p>
<p id="polarion_10">
 <br/>
</p>
<p id="polarion_11" style="text-align: center;">
 <span style="font-weight: bold;font-size: 28pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.2;">
  Spezifikation
 </span>
</p>
<p id="polarion_12" style="text-align: center;">
 <span style="font-weight: bold;font-size: 28pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.2;">
  E-Rezept-Fachdienst
 </span>
</p>
<p id="polarion_13">
 <br/>
</p>
<p id="polarion_14">
 <br/>
</p>
<p id="polarion_15">
 <br/>
</p>
<div class="polarion-dle-wiki-block" id="polarion_editor_html_block2">
 <div contenteditable="false" id="polarion_editor_html_block_content">
 </div>
 <pre class="polarion-dle-wiki-block-source" contenteditable="false" id="polarion_editor_html_block_source">{include-macros:/macros.gematikMacros}

#renderGematikDokumentenTitel($document)</pre>
</div>
<p id="polarion_16">
</p>
<h1 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20417">
 Dokumentinformationen
</h1>
<p id="polarion_21">
 <span style="font-weight: bold;">
  Änderungen zur Vorversion
 </span>
</p>
<p id="polarion_22">
 Anpassungen des vorliegenden Dokumentes im Vergleich zur Vorversion können Sie der nachfolgenden Tabelle entnehmen.
</p>
<p id="polarion_23">
</p>
<p data-keep-next="true" id="polarion_25">
 <span style="font-weight: bold;">
  Dokumentenhistorie
 </span>
</p>
<table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=3" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
 <tbody>
  <tr>
   <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 60.4px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Version
    <br/>
   </th>
   <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 67.6px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Stand
    <br/>
   </th>
   <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 50px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Kap./ Seite
    <br/>
   </th>
   <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 276.4px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Grund der Änderung, besondere Hinweise
    <br/>
   </th>
   <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 94px;height: 38px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Bearbeitung
    <br/>
   </th>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    1.0.0
   </td>
   <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    30.06.2020
   </td>
   <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
   </td>
   <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    freigegeben
   </td>
   <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    gematik
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    1.0.1
   </td>
   <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    06.07.2020
   </td>
   <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
   </td>
   <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Aktualisierung Hinweis zu Dispensierinformation
   </td>
   <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    gematik
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 60.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    1.1.0
   </td>
   <td style="text-align: left;vertical-align: top;width: 67.6px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    12.11.2020
   </td>
   <td style="text-align: left;vertical-align: top;width: 50px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
   </td>
   <td style="text-align: left;vertical-align: top;width: 276.4px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Einarbeitung gemäß Änderungsliste P22.2 / Scope-Themen zu R4.0.1
   </td>
   <td style="text-align: left;vertical-align: top;width: 94px;height: 18.8px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    gematik
   </td>
  </tr>
 </tbody>
</table>
<p id="polarion_27">
</p>
<h1 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20418">
 Inhaltsverzeichnis
</h1>
<div id="polarion_wiki macro name=toc">
</div>
<p id="polarion_38">
</p>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20419">
 1 Einordnung des Dokumentes
</h2>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20420">
 1.1 Zielsetzung
</h3>
<p id="polarion_40">
 Die vorliegende Spezifikation definiert die Anforderungen zu Herstellung, Test und Betrieb des Produkttyps E-Rezept-Fachdienst.
 <br/>
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20421">
 1.2 Zielgruppe
</h3>
<p id="polarion_17">
 Das Dokument richtet sich an den Hersteller des E-Rezept-Fachdienstes, sowie an Hersteller und Anbieter von weiteren Produkttypen der Fachanwendung E-Rezept.
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20422">
 1.3 Geltungsbereich
</h3>
<p id="polarion_53">
 Dieses Dokument enthält normative Festlegungen zur Telematikinfrastruktur des Deutschen Gesundheitswesens. Der Gültigkeitszeitraum der vorliegenden Version und deren Anwendung in Zulassungs- oder Abnahmeverfahren wird durch die gematik GmbH in gesonderten Dokumenten (z.B. Dokumentenlandkarte, Produkttypsteckbrief, Leistungsbeschreibung) fest­gelegt und bekannt gegeben.
 <br/>
</p>
<p id="polarion_54">
 <span style="font-weight: bold;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">
  Schutzrechts-/Patentrechtshinweis
 </span>
</p>
<p id="polarion_55">
 <span style="font-style: italic;font-size: 10pt;font-family: Arial, Helvetica, sans-serif;line-height: 1.5;">
  Die nachfolgende Spezifikation ist von der gematik allein unter technischen Gesichtspunkten erstellt worden. Im Einzelfall kann nicht ausgeschlossen werden, dass die Implementierung der Spezifikation in technische Schutzrechte Dritter eingreift. Es ist allein Sache des Anbieters oder Herstellers, durch geeignete Maßnahmen dafür Sorge zu tragen, dass von ihm aufgrund der Spezifikation angebotene Produkte und/oder Leistungen nicht gegen Schutzrechte Dritter verstoßen und sich ggf. die erforderlichen Erlaubnisse/Lizenzen von den betroffenen Schutzrechtsinhabern einzuholen. Die gematik GmbH übernimmt insofern keinerlei Gewährleistungen.
 </span>
</p>
<p id="polarion_18">
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20423">
 1.4 Abgrenzungen
</h3>
<p id="polarion_58">
 Spezifiziert werden in dem Dokument die von dem Produkttyp bereitgestellten (angebotenen) Schnittstellen. Benutzte Schnittstellen werden hingegen in der Spezifikation desjenigen Produkttypen beschrieben, der diese Schnittstelle bereitstellt. Auf die entsprechenden Dokumente wird referenziert (siehe auch Anhang A5).
</p>
<p id="polarion_59">
 Die vollständige Anforderungslage für den Produkttyp ergibt sich aus weiteren Konzept- und Spezifikationsdokumenten, diese sind in dem Produkttypsteckbrief des Produkttyps &lt;Produkttyp&gt; verzeichnet.
</p>
<p id="polarion_60">
</p>
<p id="polarion_61">
 Nicht Bestandteil des vorliegenden Dokumentes sind die informativen Ergänzungen zur Nutzung der Schnittstellen des E-Rezept-Fachdienstes in der separaten API-Dokumentation, sowie zur Profilierung der verwendeten FHIR-Ressourcen.
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20424">
 1.5 Methodik
</h3>
<p id="polarion_65">
 Anforderungen als Ausdruck normativer Festlegungen werden durch eine eindeutige ID in eckigen Klammern sowie die dem RFC 2119 [RFC2119] entsprechenden, in Großbuchstaben geschriebenen deutschen Schlüsselworte MUSS, DARF NICHT, SOLL, SOLL NICHT, KANN gekennzeichnet.
</p>
<p id="polarion_66">
</p>
<p id="polarion_67">
 Sie werden im Dokument wie folgt dargestellt:
 <span style="font-weight: bold;font-family: Wingdings;">
  <br/>
 </span>
 <span style="font-weight: bold;">
  &lt;AFO-ID&gt; - &lt;Titel der Afo&gt;
 </span>
 <br/>
 Text / Beschreibung
 <br/>
 [&lt;=]
</p>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20425">
 1.5.1 Hinweis auf offene Punkte
</h4>
<p id="polarion_44">
 Themen, die noch intern geklärt werden müssen oder eine Entscheidung, sind wie folgt im Dokument gekennzeichnet:
</p>
<table class="polarion-Document-table" id="polarion_wiki macro name=table;params=header=no|width=100%|uid=1" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
 <tbody>
  <tr>
   <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
    <span style="font-style: italic;color: #3366FF;">
     Beispiel für einen offenen Punkt.
    </span>
   </td>
  </tr>
 </tbody>
</table>
<p id="polarion_138">
</p>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20426">
 2 Systemüberblick
</h2>
<p id="polarion_78">
 Der E-Rezept-Fachdienst verwaltet E-Rezepte in der Telematikinfrastruktur als ein zentraler Ressourcenserver auf Basis des FHIR-Standards mit einer RESTful API. Die Rezepte werden dabei über eine eindeutige Ressourcen-ID (Rezept-ID) adressiert. Zusätzlich protokolliert der E-Rezept-Fachdienst alle Zugriffe auf ein E-Rezept für den Versicherten und verwaltet die Statusübergänge eines E-Rezepts. Für einen Nachrichtenaustausch zwischen Apotheken und Versicherten über die Verfügbarkeit von Medikamenten, die Belieferung von E-Rezepten und der Vertretung beim Einlösen eines E-Rezepts ist zusätzlich eine Kommunikation über den E-Rezept-Fachdienst möglich.
</p>
<p id="polarion_26">
 Der E-Rezept-Fachdienst realisiert die Vertraulichkeit und Integrität der verarbeiteten Daten über das Konzept der vertrauenswürdigen Ausführungsumgebung (VAU), die eine durchgängige Verschlüsselung der E-Rezepte und der dazu gehörigen Daten aus einer Kombination kryptografischer Verfahren während des Transports, der vertrauenswürdigen Verarbeitung und in der verschlüsselten Persistierung der Daten sicherstellt.
</p>
<p data-keep-next="true" id="polarion_29" style="text-align: center;">
 <img data-lastmodified="2020-04-14T14:21:46.303+02:00" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAACWBAMAAACWdajhAAAAG1BMVEV//9QAAABv37kPHxo/f2ovX09Pn4Rfv58fPzUApD1aAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACZklEQVR4nO2WQW/TQBCFF8dNOHa7tevjBoi4xoVWHGP10mNopZ6dnDgG+AM1SPC3mfGu7Vlhh4SmIkjvk9pmZ948P3lXmyoFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8x0Rm/07LdH7QLFsf/vm0t9OUJTvF6ht8eqzm0X8ViwXh4I4v+I+buM1np1h7jhxRrOn8xiyVmtybO1rN8qyMTJxfBU0e7DpjrfXc+00v780irjKruPe+kV7xekbrW/1N+YLzqoeFaFyljV0Y653WiVIrrY1VE5Kkkcm1Xsom2YhOEIs+Zzmv695jI71QEf3W38lV+YLzamJ5kan0QCyzHmsb6btJRU9J7Nsfkb62qzPRrJ8vOs1b57JZxzqxX1OKcf1qlXLtdWJnGa9tQa556QudlxSldmATL5X6WMb0TkYXqnhUfIKsOklFkwdlR8YiQb5R8Xl97uKsltKbrixryVEVC1/ovELR0Nni0ZdkQN7VRrmDTZ+7Jv+RHRmLPlJrnNQ9+mEpPaooec2uq6UvdF6haFusEW0aeed2KJbsDMZSupbyqVqIWK4QxupEzx8rOnSsw2ziJGv2x2nFJkqvULQtFh1WceR7YsnOi9OBWCd1ZBoIY7mC9+LhQNTa9cQSF8RDbyzZGZ33xlpHxZmTfok+bUQsV/BePByIWrueWP46HbtLsyeW7MTiOu1i8WEpm+tUy1iu4L3i7jp1otauL1b75fOh7I0VdOpvpN/e1o3+6Sbe5OZBbqIreC8eDkSt3bOww7+I/wLE2ocjjQUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAx8Yv0dGgYPUMKHsAAAAASUVORK5CYII=" style="width: 712px;height: 662px;"/>
</p>
<p class="polarion-rte-caption-paragraph" id="polarion_30" style="text-align: center;">
 Abbildung
 <span class="polarion-rte-caption" data-sequence="Abbildung">
  #
 </span>
 : Systemüberblick
</p>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20427">
 3 Systemkontext
</h2>
<p id="polarion_28">
 Der E-Rezept-Fachdienst stellt Schnittstellen für die Verwaltung von E-Rezepten und für den Nachrichtenaustausch bereit. Diese werden von Leistungserbringerorganisationen und Versicherten genutzt, die über ihre jeweiligen Clientsysteme auf den E-Rezept-Fachdienst zugreifen.
</p>
<p class="polarion-rte-caption-paragraph" id="polarion_37" style="text-align: center;">
 <img data-lastmodified="2020-08-10T14:23:50.220+02:00" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAACWBAMAAACWdajhAAAAG1BMVEV//9QAAABv37kPHxo/f2ovX09Pn4Rfv58fPzUApD1aAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACZklEQVR4nO2WQW/TQBCFF8dNOHa7tevjBoi4xoVWHGP10mNopZ6dnDgG+AM1SPC3mfGu7Vlhh4SmIkjvk9pmZ948P3lXmyoFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8x0Rm/07LdH7QLFsf/vm0t9OUJTvF6ht8eqzm0X8ViwXh4I4v+I+buM1np1h7jhxRrOn8xiyVmtybO1rN8qyMTJxfBU0e7DpjrfXc+00v780irjKruPe+kV7xekbrW/1N+YLzqoeFaFyljV0Y653WiVIrrY1VE5Kkkcm1Xsom2YhOEIs+Zzmv695jI71QEf3W38lV+YLzamJ5kan0QCyzHmsb6btJRU9J7Nsfkb62qzPRrJ8vOs1b57JZxzqxX1OKcf1qlXLtdWJnGa9tQa556QudlxSldmATL5X6WMb0TkYXqnhUfIKsOklFkwdlR8YiQb5R8Xl97uKsltKbrixryVEVC1/ovELR0Nni0ZdkQN7VRrmDTZ+7Jv+RHRmLPlJrnNQ9+mEpPaooec2uq6UvdF6haFusEW0aeed2KJbsDMZSupbyqVqIWK4QxupEzx8rOnSsw2ziJGv2x2nFJkqvULQtFh1WceR7YsnOi9OBWCd1ZBoIY7mC9+LhQNTa9cQSF8RDbyzZGZ33xlpHxZmTfok+bUQsV/BePByIWrueWP46HbtLsyeW7MTiOu1i8WEpm+tUy1iu4L3i7jp1otauL1b75fOh7I0VdOpvpN/e1o3+6Sbe5OZBbqIreC8eDkSt3bOww7+I/wLE2ocjjQUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAx8Yv0dGgYPUMKHsAAAAASUVORK5CYII=" style="max-width: 750px;"/>
</p>
<p class="polarion-rte-caption-paragraph" id="polarion_109" style="text-align: center;">
 Abbildung
 <span class="polarion-rte-caption" data-sequence="Abbildung">
  #
 </span>
 : Systemkontext E-Rezept-Fachdienst
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20428">
 3.1 Nachbarsysteme
</h3>
<p id="polarion_84">
 <span style="font-style: normal;">
  Die Schnittstellen des E-Rezept-Fachdienstes werden durch die Praxisverwaltungs- und Krankenhausinformationssysteme der verordnenden Leistungserbringer im Verordnungsprozess genutzt. Die Apothekenverwaltungssysteme nutzen die Schnittstellen des E-Rezept-Fachdienstes im Rahmen der Dispensierung. Außerdem werden sie vom E-Rezept-Frontend des Versicherten (E-Rezept-FdV) aufgerufen. Als Fachdienst der Telematikinfrastruktur bedient sich der E-Rezept-Fachdienst der weiteren Infrastrukturdienste wie TSP für die Gültigkeitsabfrage für Signaturzertifikate, des HBA (für QES-Prüfung) und des IdentityManagements, bei dem ein IDP Identitätsbestätigungen (ID_TOKEN, ACCESS_TOKEN) für Nutzer im Rahmen eines Sessionmanagements für das Single Sign-On ausstellt.
 </span>
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20429">
 3.2 Akteure und Rollen
</h3>
<p id="polarion_73">
 Leistungserbringerinstitutionen und Versicherte weisen sich gegenüber dem E-Rezept-Fachdienst mit einer Identitätsbestätigung (ACCESS_TOKEN) aus, die sie von einem Identitätsprovider, z.B. SmartCard-IDP, beziehen. In diesen ACCESS_TOKEN ist ihre Rollen-OID sowie ihr Identitätskennzeichen Versicherten-ID (10-stelliger unveränderlicher Anteil der KVNR) bzw. Telematik-ID enthalten. Anhand der jeweiligen Rolle wird die Zulässigkeit einer aufgerufenen Operation geprüft. Das Identitätskennzeichen wird für die Protokollierung von Zugriffen sowie die Zuordnung von Datensätzen, insbesondere bei E-Rezepten zu Versicherten, genutzt.
</p>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20430">
 4 Zerlegung des Produkttyps
</h2>
<p id="polarion_20">
 Der E-Rezept-Fachdienst verwaltet E-Rezepte über einen medizinischen Workflow. Dabei muss er die Vertraulichkeit und Integrität der verarbeiteten Daten sicherstellen. Daraus ergeben sich Sicherheitsanforderungen an die Betriebsumgebung, an die Fachlogik der Prozessverarbeitung sowie an die Ausführungsumgebung des Programmcodes.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107058|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19586">
 </a>
 <dl>
  <dt>
   A_19586 - Anbieter E-Rezept-Fachdienst Speicherung Schlüsselmaterial in HSM
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS das private Schlüsselmaterial für kryptografische Verfahren (Entschlüsselung, Signaturen) in einem HSM speichern, dessen Eignung durch eine erfolgreiche Evaluierung nachgewiesen wurde. Als Evaluierungsschemata kommen dabei Common Criteria, ITSEC oder Federal Information Processing Standard (FIPS) in Frage.
   <br/>
   Die Prüftiefe MUSS mindestens
   <ol>
    <li>
     FIPS 140-2 Level 3,
    </li>
    <li>
     Common Criteria EAL 4+ mit hohem Angriffspotenzial oder
    </li>
    <li>
     ITSEC E3 der Stärke „hoch“ entsprechen.
    </li>
   </ol>
  </dd>
 </dl>
</div>
<p id="polarion_39">
 Eine über die Schlüsselspeicherung in einem Hardware Security Module (HSM) hinausgehende Anforderung an die Zerlegung des E-Rezept-Fachdienstes gibt es aus funktionaler Sicht nicht.
</p>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20431">
 5 Übergreifende Festlegungen
</h2>
<p id="polarion_64">
 Der folgende Abschnitt beschreibt übergreifende Anforderungen an den E-Rezept-Fachdienst zur Unterstützung der Fachlogik.
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20432">
 5.1 Servicelokalisierung
</h3>
<p id="polarion_74">
 Die Schnittstellen des E-Rezept-Fachdienstes werden über verschiedene Netzsegmente von Leistungserbringern und Versicherten aufgerufen. Dafür müssen diese Schnittstellen über DNS-Abfragen lokalisierbar sein.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104286|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19410">
 </a>
 <dl>
  <dt>
   A_19410 - Anbieter E-Rezept-Fachdienst - PTR für Anbieterliste (RFC Service-Discovery)
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS DNS PTR, SRV und TXT Resource Records im Namensraum der TI gemäß folgender Tabelle verwalten.
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_001 Service Discovery
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 151px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        Resource Record Bezeichner
       </span>
       <br/>
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 109px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        Resource Record Type
       </span>
       <br/>
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 460px;height: 57px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        Beschreibung
       </span>
       <br/>
      </th>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 151px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        _erp._tcp.erp.ti-dienste.de
        <span id="polarion-comment:279">
        </span>
       </span>
       <br/>
      </td>
      <td style="text-align: left;vertical-align: top;width: 109px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        PTR
       </span>
       <br/>
      </td>
      <td style="text-align: left;vertical-align: top;width: 460px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        Ermittlung der E-Rezeptschnittstelle &lt;erp_service_name&gt;
       </span>
       <br/>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 151px;height: 59px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        &lt;erp_service_name&gt;
       </span>
       <br/>
      </td>
      <td style="text-align: left;vertical-align: top;width: 109px;height: 59px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        SRV und TXT
       </span>
       <br/>
      </td>
      <td style="text-align: left;vertical-align: top;width: 460px;height: 59px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-size: 10pt;line-height: 1.5;">
        SRV Resource Record zur Ermittlung des FQDN des E-Rezept-Dienstes
       </span>
       <br/>
       <span style="font-size: 10pt;line-height: 1.5;">
        TXT Resource Record zur Ermittlung des Pfades der URL zum E-Rezept-Dienst "path=&lt;
       </span>
       <span style="font-size: 10pt;color: #1F497D;line-height: 1.5;">
        Bezeichner der Schnittstelle als Pfadbestandteil (ohne /)
       </span>
       <span style="font-size: 10pt;line-height: 1.5;">
        &gt;"
       </span>
       <br/>
      </td>
     </tr>
    </tbody>
   </table>
  </dd>
 </dl>
</div>
<p class="MsoNoSpacing" id="polarion_76">
 <span style="font-size: 10pt;line-height: 1.5;">
  Der Eintrag &lt;erp_service_name&gt; ist als Variable zu verstehen und kann zum Beispiel für die Namensauflösung durch die Primärsysteme folgende Ausprägung besitzen:
 </span>
</p>
<p id="polarion_95">
 <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
  _erp._tcp.erp.ti-dienste.de 86400 IN PTR _erp-fd._tcp.erp.ti-dienste.de
 </span>
</p>
<p class="MsoNoSpacing" id="polarion_114">
 <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
  _erp-fd._tcp.erp.ti-dienste.de 86400 IN SRV 5 10 443 erp-srv.zentral.erp.ti-dienste.de
 </span>
</p>
<p class="MsoNoSpacing" id="polarion_118">
 <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
  _erp-fd._tcp.erp.ti-dienste.de 86400 IN TXT „txtvers=1“ „path=/“
 </span>
</p>
<p id="polarion_68">
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104287|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19411">
 </a>
 <dl>
  <dt>
   A_19411 - Anbieter E-Rezept-Fachdienst - Resource Records FQDN eRP
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS im Namensraum der TI und in den Nameservern Internet die Ressource Records gemäß nachstehender Tabelle verwalten.
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_002 FQDN
   </p>
   <table style="width: 99.87%;margin-left: auto;margin-right: auto;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 181px;height: 14pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       Resource Record Bezeichner
      </th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 97px;height: 14pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       <span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">
        Resource Record Type
       </span>
       <br/>
      </th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 435px;height: 14pt;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       <span style="font-weight: bold;font-size: 10pt;line-height: 1.5;">
        Beschreibung
       </span>
       <br/>
      </th>
     </tr>
     <tr>
      <td style="vertical-align: top;width: 181px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       erp-srv.zentral.erp.ti-dienste.de
       <span style="background-color: #FFFF99;">
        <span id="polarion-comment:280">
        </span>
       </span>
      </td>
      <td style="vertical-align: top;width: 97px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       A Record
      </td>
      <td style="vertical-align: top;width: 435px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       A Resource Records zur Namensauflösung von FQDN des E-Rezept-Fachdienstes in IP-Adressen im Namensraum der TI
       <br/>
      </td>
     </tr>
     <tr>
      <td style="vertical-align: top;width: 181px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       erp-srv.zentral.erp.ti-dienste.de
      </td>
      <td style="vertical-align: top;width: 97px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       <span style="font-size: 10pt;line-height: 1.5;">
        A Record
       </span>
       <br/>
      </td>
      <td style="vertical-align: top;width: 435px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       <span style="font-size: 10pt;line-height: 1.5;">
        A Resource Records zur Namensauflösung von FQDN des E-Rezept-Fachdienstes in IP-Adressen im Namensraum Internet
       </span>
       <br/>
      </td>
     </tr>
     <tr>
      <td style="vertical-align: top;width: 181px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       erp-srv.zentral.erp.ti-dienste.de
      </td>
      <td style="vertical-align: top;width: 97px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       AAAA Record
      </td>
      <td style="vertical-align: top;width: 435px;height: 25px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       AAAA Resource Records zur Namensauflösung von FQDN des E-Rezept-Fachdienstes in IP-Adressen im Namensraum Internet
      </td>
     </tr>
     <tr>
      <td style="vertical-align: top;width: 181px;height: 27px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       _erp._tcp.erp.ti-dienste.de
      </td>
      <td style="vertical-align: top;width: 97px;height: 27px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       <span style="font-size: 10pt;line-height: 1.5;">
        TXT
       </span>
       <br/>
      </td>
      <td style="vertical-align: top;width: 435px;height: 27px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 4pt;">
       <span style="font-size: 10pt;line-height: 1.5;">
        TXT Resource Records zur Ermittlung der Aufruf-Schnittstelle des E-Rezept-Fachdienstes. Der für die Adressierung benötigte Resource Record MUSS bereitgestellt werden. Das in den Klammern angegebene Kürzel MUSS verwendet werden.
        <br/>
       </span>
       <ul>
        <li>
         <span style="font-size: 10pt;line-height: 1.5;">
          E-Rezept-Schnittstelle (erp)
         </span>
        </li>
        <li>
         OCSP-Status-Proxy (ocspf)
        </li>
       </ul>
       Das key/value-Paar des TXT-Records hat folgende Struktur (die spitzen Klammern dienen der Abgrenzung eines Wertes):
       <br/>
       "erp=&lt;Schnittstelle E-Rezept&gt;"
       <br/>
      </td>
     </tr>
    </tbody>
   </table>
  </dd>
 </dl>
</div>
<p id="polarion_62">
 Exemplarisch können die DNS-Einträge im Namensraum Internet für den E-Rezept-Fachdienst wie folgt aussehen:
</p>
<p class="MsoNoSpacing" id="polarion_72">
 <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
  _erp._tcp.erp.ti-dienste.de 86400 IN TXT „txtvers=1“ „path=/“
 </span>
</p>
<p class="MsoNormal" id="polarion_79">
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  erp-srv.zentral.erp.ti-dienste.de IN A 10.28.2.42
 </span>
</p>
<p id="polarion_43">
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  erp-srv.zentral.erp.ti-dienste.de IN AAAA
  <code>
   2001:db8::1
  </code>
 </span>
</p>
<p id="polarion_63">
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104288|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19412">
 </a>
 <dl>
  <dt>
   A_19412 - Anbieter E-Rezept-Fachdienst - Schnittstellenadressierung
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS die im Internet  angebotene Schnittstelle des E-Rezept-Fachdienstes unter der folgenden URL zur Verfügung stellen:
   <br/>
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    https://&lt;FQDN aus DNS Lookup&gt;:443/&lt;Aufrufschnittstelle aus TXT Record "path"&gt;
    <br/>
    <br/>
    z.B. erp.zentral.erp.ti-dienste.de/
   </span>
   <br/>
  </dd>
 </dl>
</div>
<p id="polarion_49">
 Um Benutzern den Umgang mit E-Rezepten zu erleichtern, wird die Nutzung der Endnutzeranwendung E-Rezept-FdV als App auf ihrem privaten Smartphone empfohlen. Der E-Rezept-Fachdienst unterstützt dabei die App-Nutzung durch Digital Asset Links (für Android) [DAL_ANDROID] und Universal Links (für iOS/macOS) [UL_APPLE].
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107376|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19695">
 </a>
 <dl>
  <dt>
   A_19695 - E-Rezept-Fachdienst - Android Digital Asset Link
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS ein Asset Link Statement
   <span style="font-size: 10pt;color: #202124;line-height: 1.5;">
    gemäß [DAL_ANDROID] mit der Liste der Hashwerte der aktuell zugelassenen Android-Versionen des E-Rezept-FdV
    <span id="polarion-comment:220">
    </span>
    für den Wert "
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     sha256_cert_fingerprints
    </span>
    " unter der Internetadresse
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     https://&lt;FQDN für DNS Lookup&gt;/.well-known/assetlinks.json
    </span>
    veröffentlichen und pflegen, damit Versicherte mit einem Android-Smartphone E-Rezepte standardmäßig mit dem E-Rezept-FdV verwalten können.
   </span>
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20433">
 5.2 Authentifizierung von Nutzern
</h3>
<p id="polarion_112">
 Die Identifikation von Nutzern erfolgt nach dem Standard OpenID-Connect, hierfür stellt ein Identity Provider der Telematikinfrastruktur ACCESS_TOKEN für Nutzer aus, die er anhand ihrer identifizierenden Merkmale (z.B. eGK, SMC-B) authentifiziert.
</p>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20434">
 5.2.1 Registrierung beim Identity Provider
</h4>
<p id="polarion_33">
 Der E-Rezept-Fachdienst delegiert die Authentifizierung von Nutzern an einen Identity Provider. Für diesen Zweck muss er sich bei diesem als Relying Party registrieren und die für die Fachlogik notwendigen Attribute in den Identitätsbestätigungen (ACCESS_TOKEN)  festlegen. Die Umsetzung des IdentityManagements über Identity Provider startet mit einem einzelnen IDP (Smartcard-IDP), später werden weitere Identity Provider bei den verschiedenen identitätsbestätigenden Stellen realisiert. Verwaltet ein solcher IDP Identitäten von Nutzern der Telematikinfrastruktur und gilt als vertrauenswürdig für die Umsetzung von UseCases unter Nutzung der Schnittstellen des E-Rezept-Fachdienstes, obliegt es dem E-Rezept-Fachdienst, sich bei diesem IDP als RelyingParty zu registrieren.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108435|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19985">
 </a>
 <dl>
  <dt>
   A_19985 - Anbieter E-Rezept-Fachdienst - Registrierung beim IDP als Relying Party
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS sich über einen organisatorischen Prozess bei einem vertrauenswürdigen Identity Provider (IDP) der Telematikinfrastruktur als Relying Party registrieren und die Bereitstellung der folgenden Claims in für Nutzer ausgestellte ACCESS_TOKEN mit dem IDP vereinbaren:
   <br/>
   <ul>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      professionOID
     </span>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      given_name
     </span>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      family_name
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      organizationName
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      idNummer
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      acr
     </span>
    </li>
   </ul>
   damit der E-Rezept-Fachdienst die Fachlogik der Autorisierung und Protokollierung auf diesen Attributen umsetzen kann.
   <span id="polarion-comment:254">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-111923|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20706">
 </a>
 <dl>
  <dt>
   A_20706 - Anbieter E-Rezept-Fachdienst - Claims für ID_TOKEN für FdV
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP die Bereitstellung der folgenden Claims in für Nutzer ausgestellte ID_TOKEN mit dem IDP vereinbaren:
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    <span id="polarion-comment:260">
    </span>
   </span>
   <br/>
   <ul>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      professionOID
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      given_name
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      family_name
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      organizationName
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      idNummer
     </span>
     <br/>
    </li>
    <li>
     <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
      acr
     </span>
    </li>
   </ul>
   damit ein E-Rezept-Client diese Informationen bei Bedarf auswerten kann.
   <span id="polarion-comment:240">
   </span>
   <span id="polarion-comment:255">
   </span>
   <span id="polarion-comment:271">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112188|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20754">
 </a>
 <dl>
  <dt>
   A_20754 - Anbieter E-Rezept-Fachdienst - Registrierung Scope
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP das Attribut "Scope" mit dem Wert "openid profile prescriptionservice.lei" zur Nutzung durch Primärsysteme und dem Wert "openid profile prescriptionservice.vers" zur Nutzung durch Clients der Internetschnittstelle beantragen.
   <span id="polarion-comment:274">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108436|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19986">
 </a>
 <dl>
  <dt>
   A_19986 - Anbieter E-Rezept-Fachdienst - E-Rezept-Sessiondauer im IDP
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP die Ausstellung von ACCESS_TOKEN für authentifizierte Nutzer für die maximale Dauer von 12 Stunden erlauben, sodass der IDP spätestens 12 Stunden nach
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    auth_time
   </span>
   eine Re-Authentifizierung des Nutzers erzwingt.
   <span id="polarion-comment:241">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-111937|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20710">
 </a>
 <dl>
  <dt>
   A_20710 - Anbieter E-Rezept-Fachdienst - E-Rezept-Lebensdauer ACCESS_TOKEN
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP eine Lebensdauer von ausgestellten ACCESS_TOKEN durch den IDP für die Berechnung des Werts "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    tokenTimeout
   </span>
   " von 300 Sekunden festlegen.
   <span id="polarion-comment:253">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108437|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19987">
 </a>
 <dl>
  <dt>
   A_19987 - Anbieter E-Rezept-Fachdienst - URI für öffentl. Schlüssel Tokenverschlüsselung
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS bei der Registrierung als Relying Party im IDP die beiden URI bzw. FQDN der Schnittstellen im Namensraum der TI und im Internet sowie die Abrufadresse des öffentlichen Schlüssels PUK_FD mit Angabe des zu verwendenden Algorithmus für die Verschlüsselung des ACCESS_TOKEN dem Identity Provider bekannt machen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108447|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19993">
 </a>
 <dl>
  <dt>
   A_19993 - E-Rezept-Fachdienst - Prüfung eingehender ACCESS_TOKEN
  </dt>
  <dd>
   Der
   <span id="polarion-comment:207">
   </span>
   E-Rezept-Fachdienst MUSS jedes mit einem eingehenden HTTP-Request übergebene ACCESS_TOKEN gemäß der Festlegungen in [gemSpec_IDP_FD#Kapitel 6 ACCESS_TOKEN] prüfen und Fehler bzw. ungültige Token gemäß dieser Festlegungen und dem HTTP-Status-Code 401 abweisen.
   <span id="polarion-comment:242">
   </span>
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20435">
 5.2.2 Claims der Identitätsbestätigung
</h4>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103556|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19130">
 </a>
 <dl>
  <dt>
   A_19130 - E-Rezept-Fachdienst - Authentifizierung erforderlich LEI-Endpunkt
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests über den Endpunkt für Leistungserbringerinstitutionen mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "
   <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
    WWW-Authenticate: Bearer realm='prescriptionserver.telematik'
   </span>
   <pre> scope=openid profile prescriptionservice.lei"</pre>
   abweisen, die kein ACCESS_TOKEN als JSON-Web-Token-Format gemäß [JWT] im HTTP-Request-Header "Authorization" bereitstellen, damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104260|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19389">
 </a>
 <dl>
  <dt>
   A_19389 - E-Rezept-Fachdienst - Authentifizierung erforderlich Vers-Endpunkt
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests über den Endpunkt für den Zugriff für Versicherte mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "
   <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
    WWW-Authenticate: Bearer realm='prescriptionserver.telematik'
   </span>
   <pre>scope=openid profile prescriptionservice.vers"</pre>
   abweisen, die kein ACCESS_TOKEN als JSON-Web-Token-Format gemäß [JWT] im HTTP-Request-Header "Authorization" bereitstellen, damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103557|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19131">
 </a>
 <dl>
  <dt>
   A_19131 - E-Rezept-Fachdienst - Authentifizierung ungültig
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "
   <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
    WWW-Authenticate: Bearer realm='prescriptionserver.telematik', error='invalACCESS_TOKEN'"
   </span>
   <span style="font-size: 10pt;font-family: Arial, Helvetica;line-height: 1.5;">
   </span>
   abweisen, die ein unsigniertes oder ungültiges ACCESS_TOKEN im HTTP-Request-Header "Authorization" bereitstellen, damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107957|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19902">
 </a>
 <dl>
  <dt>
   A_19902 - E-Rezept-Fachdienst - Authentifizierung abgelaufen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle eingehenden HTTP-Requests mit dem HTTP-Fehlercode 401 und dem HTTP-Response-Header "
   <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
    WWW-Authenticate: Bearer realm='prescriptionserver.telematik', error='invalACCESS_TOKEN'"
   </span>
   <span style="font-family: Arial, Helvetica;">
    <span style="font-size: 10pt;line-height: 1.5;">
    </span>
    abweise
    <span style="font-size: 10pt;line-height: 1.5;">
     n
    </span>
   </span>
   <span style="font-size: 10pt;line-height: 1.5;">
    , die ein ACCESS_TOKEN im HTTP-Request-Header "Authorization" bereitstellen, dessen Gültigkeitsendezeitpunkt "
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     exp"
    </span>
    älter als die aktuelle Systemzeit oder dessen Ausstellzeitpunkt "
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     iat"
    </span>
    älter als die aktuelle Systemzeit - 5 Minuten ist,
   </span>
   damit ausschließlich authentifizierte Nutzer Zugriff auf die HTTP-Schnittstelle des E-Rezept-Fachdienstes erhalten.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103558|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19132">
 </a>
 <dl>
  <dt>
   A_19132 - E-Rezept-Fachdienst - Authentifizierung Signaturprüfung
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die Signatur jedes im HTTP-Header "Authorization" eines eingehenden HTTP-Requests übergebenen JSON-Web-Tokens gemäß [JWS] prüfen und bei Ungültigkeit oder bei Signatur durch einen Identity Provider, bei dem der E-Rezept-Fachdienst nicht als Relying Party registriert ist, den HTTP-Request mit dem HTTP-Fehlercode 401 abweisen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104259|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19390">
 </a>
 <dl>
  <dt>
   A_19390 - E-Rezept-Fachdienst - Authentifizierung Nutzerrolle
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die fachliche Rolle eines Nutzers in jedem Operationsaufruf anhand des Attributs "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID"
   </span>
   im übergebenen IDP-Token im HTTP-Header "Authorization" feststellen und für die nachfolgende Rollenprüfung je Operationsaufruf verwenden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104257|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19391">
 </a>
 <dl>
  <dt>
   A_19391 - E-Rezept-Fachdienst - Authentifizierung Nutzername
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS den Namen eines Nutzers in jedem Operationsaufruf anhand der Attribute "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    given_name
   </span>
   ", "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    family_name
   </span>
   " und "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    organizationName"
   </span>
   im übergebenen IDP-Token im HTTP-Header "Authorization" feststellen und für die Protokollierung des Zugriffs auf personenbezogene medizinische Daten je Operationsaufruf verwenden.
   <span id="polarion-comment:270">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104261|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19392">
 </a>
 <dl>
  <dt>
   A_19392 - E-Rezept-Fachdienst - Authentifizierung Nutzerkennung
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die Nutzerkennung (10-stelliger Teil der KVNR, Telematik-ID für Leistungserbringerinstitutionen) eines Nutzers in jedem Operationsaufruf anhand des Attributs "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    idNummer"
   </span>
   im übergebenen IDP-Token im HTTP-Header "Authorization" feststellen und für die Protokollierung des Zugriffs auf personenbezogene medizinische Daten je Operationsaufruf verwenden.
   <span id="polarion-comment:256">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104352|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19439">
 </a>
 <dl>
  <dt>
   A_19439 - E-Rezept-Fachdienst - Authentifizierung Authentifizierungsstärke
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die Authentifizierungsstärke des übergebenen IDP-Token anhand des Attributs "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    acr"
   </span>
   im übergebenen IDP-Token im HTTP-Header "Authorization" auf dem Authentifizierungsniveau "hoch" feststellen und einen anderen Wert als bzw. ein Authentifizierungsniveau unterhalb von "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    <a class="descriptionLink" href="http://eidas.europa.eu/LoA/high" target="_top">
     http://eidas.europa.eu/LoA/high
    </a>
   </span>
   "
   <span id="polarion-comment:16">
   </span>
   mit dem HTTP-Status-Code 401 ablehnen.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20436">
 5.2.3 Verwaltung der Nutzersession
</h4>
<p id="polarion_113">
 Der Identity Provider übernimmt für den E-Rezept-Fachdienst als Relying Party die Verwaltung von Nutzersessions und stellt dem Client während der Gültigkeit der Nutzersession ACCESS_TOKEN für den Zugriff auf den E-Rezept-Fachdienst aus. Der E-Rezept-Fachdienst prüft diese ACCESS_TOKEN auf Gültigkeit gemäß der Festlegungen in [gemSpec_IDP_FD].
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108444|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19992">
 </a>
 <dl>
  <dt>
   A_19992 - E-Rezept-Fachdienst - Blocklisting zu häufig verwendeter ACCESS_TOKEN
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS ein während einer konfigurierbaren Dauer vielfach vorgelegtes ACCESS_TOKEN (z.B. mehr als 10 mal innerhalb einer Sekunde) für den Rest der angegebenen Gültigkeitsdauer auf einer Blocklist führen und eingehende HTTP-Requests mit diesem ACCESS_TOKEN mit dem HTTP-Status-Code 429 ablehnen, damit ein Überlastungsangriff (DOS-Attacke) auf den E-Rezept-Fachdienst unterbunden werden kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-109249|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20158">
 </a>
 <dl>
  <dt>
   A_20158 - E-Rezept-Fachdienst - Prüfung Signaturzertifikat IDP
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS mindestens einmal täglich das Signatur-Zertifikat des IDP-Dienstes für die Signatur von ACCESS_TOKEN gemäß [gemSpec_PKI#TUC_PKI_018] mit folgenden Parametern auf Gültigkeit prüfen:
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_005 Parameter Prüfung Signaturzertifikat IDP
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Parameter
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
      </th>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Zertifikat
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Signaturzertifikat des IDP (eingebettet in ACCESS_TOKEN) C.FD.SIG
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       PolicyList
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       oid_fd_sig
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       intendedKeyUsage
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       nonRepudiation
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       intendedExtendedKeyUsage
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       (leer)
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       OCSP-Graceperiod
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       60 Minuten
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Offline-Modus
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       nein
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Prüfmodus
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       OCSP
      </td>
     </tr>
    </tbody>
   </table>
   <br/>
   Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befunden werden und der HTTP-Request andernfalls mit dem HTTP-Status-Code 401 abgelehnt werden, damit sichergestellt wird dass, ausschließlich ACCESS_TOKEN von einem vertrauenswürdigen IDP akzeptiert werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112424|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20765">
 </a>
 <dl>
  <dt>
   A_20765 - E-Rezept-Fachdienst - Prüfung Signaturzertifikat E-Rezept-Fachdienst
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS sein Signatur-Zertifikat für die Signatur der E-Rezept-Quittung gemäß [gemSpec_PKI#TUC_PKI_018] mit folgenden Parametern auf Gültigkeit prüfen:
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_010 Parameter Prüfung Signaturzertifikat
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Parameter
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
      </th>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Zertifikat
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Signaturzertifikat des E-Rezept-Fachdienstes C.FD.SIG
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       PolicyList
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       oid_fd_sig
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       intendedKeyUsage
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       nonRepudiation
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       intendedExtendedKeyUsage
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       (leer)
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       OCSP-Graceperiod
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       60 Minuten
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Offline-Modus
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       nein
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Prüfmodus
      </td>
      <td style="text-align: left;vertical-align: top;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       OCSP
      </td>
     </tr>
    </tbody>
   </table>
   <br/>
   Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befunden werden und eingehende HTTP-Request zur Erstellung einer Quittung andernfalls mit dem HTTP-Status-Code 500 abgelehnt werden, damit sichergestellt wird, dass ausschließlich Quittungen mit einem gültigen Signaturzertifikat erstellt werden.
   <span id="polarion-comment:281">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-113375|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20974">
 </a>
 <dl>
  <dt>
   A_20974 - E-Rezept-Fachdienst - Prüfungsintervall Signaturzertifikat E-Rezept-Fachdienst
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS mindestens einmal täglich sein Signatur-Zertifikat für die Signatur der E-Rezept-Quittung auf Gültigkeit prüfen.
   <span id="polarion-comment:299">
   </span>
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20437">
 5.3 Fehlercodes
</h3>
<p id="polarion_139">
 Der E-Rezept-Fachdienst stellt eine http-Schnittstelle für den Aufruf durch Clientsysteme bereit. Das Ergebnis der Operation wird in der Verwendung von http-StatusCodes [HTTP-STATUS-CODES] mitgeteilt. Die folgende Tabelle listet die vom E-Rezept-Fachdienst genutzten http-StatusCodes auf.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104484|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19514">
 </a>
 <dl>
  <dt>
   A_19514 - E-Rezept-Fachdienst - Http-Status-Codes
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die in der folgenden Tabelle aufgelisteten HTTP-Status-Codes im http-Response-Header der aufgerufenen Operation gemäß der angegebenen Bedingung zurückgeben.
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
   </p>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_003 Übersicht HTTP-Statuscodes
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=99.87%|uid=141" style="width: 99.87%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       HTTP-Status-Code
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Bedeutung
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       in welchen Operationen als Statuscode möglich
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Bedingung
      </th>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       200
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Operation erfolgreich beendet, in der Rückgabe ist ggfs. das Ergebnis der Operation enthalten
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       GET /notifications/opt-in
       <br/>
       GET /notifications/opt-out
       <br/>
       GET, etc für alle übrigen Operationen
       <br/>
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Die Operation wurde erfolgreich bearbeitet. In der Rückgabe sind die erzeugten bzw. gelesenen Daten enthalten.
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       201
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Neues Objekt wurde erfolgreich angelegt, in der Rückgabe ist das Objekt enthalten
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       POST /Task/&lt;id&gt;/$create
       <br/>
       POST /Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der E-Rezept-Fachdienst hat die Ressource in der angeforderten Operation erzeugt.
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       204
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Die Operation liefert keinen Rückgabewert
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Task/&lt;id&gt;/$reject
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Das Löschen eines E-Rezepts löscht alle personenbezogenen und medizinischen Daten, daher gibt es keine Daten in der Rückgabe der Operation. Das Zurückweisen eines Rezepts bedeutet die Nicht-Bearbeitung durch eine Apotheke, daher sind hier keine Rückgabedaten erforderlich.
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       400
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Bad Request, der Operationsaufruf enthält ungültige Daten.
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
       <br/>
       GET /notifications/opt-in
       <br/>
       GET, POST, etc für alle übrigen Operationen
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       In der aufgerufenen Operation werden vom Client Daten für die Verarbeitung erwartet. Entsprechen sie nicht dem erwarteten FHIR-Profil oder sind sie ungültig (bspw. Signatur), werden sie vom E-Rezept-Fachdienst zurückgewiesen.
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       401
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der Nutzer konnte nicht authentifiziert werden
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der Aufruf enthält keine oder abgelaufene oder ungültige Authentifizierungsinformationen im HTTP-Request-Header "
       <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
        Authorization
       </span>
       "
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       403
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der Nutzer ist nicht berechtigt, die aufgerufene Operation anzufordern
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Gemäß Rollenprüfung in jedem Operationsaufruf sind nur bestimmte Operationen je aufrufendem Nutzer zulässig.
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       404
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Die adressierte Ressource wurde nicht gefunden.
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task/&lt;id&gt;
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       GET /AuditEvent/&lt;id&gt;
       <br/>
       GET /Communication/&lt;id&gt;
       <br/>
       GET /MedicationDispense/&lt;id&gt;
       <br/>
       GET /notifications/opt-out
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Die über die &lt;id&gt; adressierte Ressource existiert nicht, d.h. wurde auch nicht zwischenzeitlich gelöscht (siehe Code 410).
       <br/>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       405
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Die Anfrage ist gültig, jedoch in Kombination mit anderen Aufrufparametern nicht gültig
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       In der Operation wird eine unzulässige Kombination aus http-Operation auf eine bestimmte Ressource ggfs. in Verbindung mit einer FHIR-Operation aufgerufen, z.B.
       <br/>
       POST /AuditEvent
       <br/>
       POST /Task/$activate
       <br/>
       POST /Task/&lt;id&gt;/$create
       <br/>
       PUT /&lt;Ressource&gt;/
       <br/>
       HEAD /&lt;Ressource&gt;
       <br/>
       DELETE /&lt;Ressource/&gt;
       <br/>
       PATCH /&lt;Ressource&gt;
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       408
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Request Timeout. Die Anfrage konnte innerhalb der erwarteten Zeit nicht beantwortet werden
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der E-Rezept-Fachdienst ist überlastet und kann die Anfrage innerhalb der Wartezeit des Clients (PVS, AVS, FdV) nicht beantworten
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       409
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Konflikt im Aufruf verschiedener Nutzer um das gleiche Objekt
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$abort
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Das E-Rezept befindet sich bereits in Belieferung durch einen Apotheker. Daher kann es vom Verordnenden und Versicherten nicht gelöscht werden ($abort) und von keinem anderen Apotheker heruntergeladen werden ($accept)
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       410
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Das aufgerufene Objekt wurde zwischenzeitlich gelöscht
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task/&lt;id&gt;
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$abort
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der Client (PVS, AVS, FdV) versucht ein E-Rezept zu lesen, das zwischenzeitlich gelöscht wurde
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       429
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der Client hat zu viele Aufrufe innerhalb einer festgelegten Zeitspanne getätigt
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Der Client (PVS, AVS, FdV) hat innerhalb des konfigurierten Zeitabschnitts zu viele Requests geschickt
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 53px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       500
      </td>
      <td style="text-align: left;vertical-align: top;width: 144px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Interner Serverfehler
      </td>
      <td style="text-align: left;vertical-align: top;width: 236px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       GET /Task
       <br/>
       GET /Task/&lt;id&gt;
       <br/>
       GET /AuditEvent/
       <br/>
       GET /Communication
       <br/>
       GET /MedicationDispense
       <br/>
       POST /Task/$create
       <br/>
       POST /Task/&lt;id&gt;/$activate
       <br/>
       POST /Task/&lt;id&gt;/$accept
       <br/>
       POST /Task/&lt;id&gt;/$reject
       <br/>
       POST /Task/&lt;id&gt;/$close
       <br/>
       POST /Task/&lt;id&gt;/$abort
       <br/>
       POST /Communication
       <br/>
       GET, POST, etc für alle übrigen Operationen
      </td>
      <td style="text-align: left;vertical-align: top;width: 275px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       In allen Operationen, die aufgrund eines internen Fehlers nicht bearbeitet werden können. Die Rückgabe liefert keine weiteren Informationen.
      </td>
     </tr>
    </tbody>
   </table>
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20438">
 5.4 Protokollierung
</h3>
<p id="polarion_105">
 Der E-Rezept-Fachdienst soll Protokolldateien schreiben, die eine Analyse technischer Vorgänge erlauben. Diese Protokolldateien sind dafür vorgesehen, aufgetretene Fehler zu identifizieren und die Performance zu analysieren. Für diese Zwecke führt der E-Rezept-Fachdienst ein Systemprotokoll, mit dem der Anbieter des Dienstes jederzeit den Betriebszustand des Systems kontrollieren kann.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103853|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19282">
 </a>
 <dl>
  <dt>
   A_19282 - E-Rezept-Fachdienst - Systemprotokoll für Betriebszustand
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS ein Systemprotokoll über durchgeführte Operationen und deren Erfolg/Misserfolg führen, um dem Anbieter des Dienstes jederzeit eine Übersicht über den aktuellen Betriebszustand zu ermöglichen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103854|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19283">
 </a>
 <dl>
  <dt>
   A_19283 - E-Rezept-Fachdienst - Systemprotokoll ohne personenbezogene und ohne medizinische Daten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS in jedem zu tätigenden Systemprotokolleintrag alle personenbezogenen, personenbeziehbaren und medizinischen Informationen vor der Speicherung entfernen, damit vom administrativen Personal keine personenbezogenen Daten der Versicherten oder Leistungserbringer eingesehen werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107347|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19678">
 </a>
 <dl>
  <dt>
   A_19678 - E-Rezept-Fachdienst -Systemprotokoll  Verfügbarkeit interner Logdaten
  </dt>
  <dd>
   Der Betreiber des E-Rezept-Fachdienstes MUSS im Rahmen von Testmaßnahmen dem Testbetriebsverantwortlichen auf Anforderung die Log-Dateien des Systemprotokolls übermitteln.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108467|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20001">
 </a>
 <dl>
  <dt>
   A_20001 - E-Rezept-Fachdienst -Systemprotokoll zu Ergebnis einer aufgerufenen Operation
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS ein Systemprotokoll über durchgeführte Operationen und deren Erfolg/Misserfolg führen.
  </dd>
 </dl>
</div>
<p id="polarion_75">
 Der E-Rezept-Fachdienst führt außerdem Zugriffsprotokolle für Versicherte, in denen alle Zugriffe auf die personenbezogenen und medizinischen Daten eines Versicherten für den Versicherten einsehbar sind. Diese Zugriffsprotokolle sind unabhängig vom Systemprotokoll und stehen ausschließlich dem Versicherten zur Wahrnehmung seiner Betroffenenrechte zur Einsicht zur Verfügung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103856|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19284">
 </a>
 <dl>
  <dt>
   A_19284 - E-Rezept-Fachdienst - Versichertenprotokoll zu Operationen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS jeden Aufruf der folgenden Operationen protokollieren:
   <br/>
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_004 Versichertenprotokoll
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 92px;height: 42px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Operation
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 206px;height: 42px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Rolle des
       <br/>
       zugreifenden Nutzers
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 422px;height: 42px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Beschreibung (ggfs. als Vorschlag für einen lesbaren Protokolleintrag in einfacher Sprache)
      </th>
     </tr>
     <tr>
      <th colspan="3" rowspan="1" style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 742px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       http GET /Task bzw. http GET /Task/&lt;id&gt;
      </th>
     </tr>
     <tr>
      <td colspan="1" rowspan="2" style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       -
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Versicherter,
       <br/>
       Vertreter
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Patient/Versicherter/Vertreter hat das E-Rezept heruntergeladen
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheker
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke hat die E-Rezept-Quittung heruntergeladen
      </td>
     </tr>
     <tr>
      <td colspan="3" rowspan="1" style="text-align: left;vertical-align: top;width: 742px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-weight: bold;">
        http POST /Task
       </span>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       $activate
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Arzt-/Zahnarztpraxis/Krankenhaus
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Arzt-/Zahnarztpraxis/Krankenhaus hat das E-Rezept bereitgestellt
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       $accept
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke hat das E-Rezept heruntergeladen
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       $reject
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke hat das E-Rezept zurückgegeben
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       $close
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke hat das E-Rezept beliefert
      </td>
     </tr>
     <tr>
      <td colspan="1" rowspan="3" style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       $abort
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Versicherter,
       <br/>
       Vertreter
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Patient/Versicherter/Vertreter hat das E-Rezept gelöscht
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Arzt-/Zahnarztpraxis/Krankenhaus
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Arzt-/Zahnarztpraxis/Krankenhaus hat das E-Rezept gelöscht
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Apotheke hat das E-Rezept gelöscht
      </td>
     </tr>
     <tr>
      <td colspan="3" rowspan="1" style="text-align: left;vertical-align: top;width: 742px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-weight: bold;">
        http GET /MedicationDispense
       </span>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
      </td>
      <td style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Versicherter,
       <br/>
       Vertreter
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Patient/Versicherter hat Medikament-Informationen heruntergeladen
      </td>
     </tr>
     <tr>
      <td colspan="3" rowspan="1" style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <span style="font-weight: bold;">
        Automatisches Löschen durch den Fachdienst
       </span>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Ressource Task
      </td>
      <td colspan="1" rowspan="4" style="text-align: left;vertical-align: top;width: 206px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       E-Rezept-Fachdienst
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Veraltete E-Rezepte vom Fachdienst automatisch gelöscht
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Ressource MedicationDispense
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Veraltete Medikament-Informationen vom Fachdienst automatisch gelöscht
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Ressource AuditEvent
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Veraltete Protokolleinträge vom Fachdienst automatisch gelöscht
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 92px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Ressource Communication
      </td>
      <td style="text-align: left;vertical-align: top;width: 422px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Veraltete Nachrichten vom Fachdienst automatisch gelöscht
      </td>
     </tr>
    </tbody>
   </table>
   <br/>
   und die gelesene bzw. geschriebene Ressource im Protokolleintrag
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    AuditEvent.entity.what
   </span>
   als Referenz hinzufügen, sowie die KVNR des betroffenen Versicherten in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    AuditEvent.entity.name
   </span>
   speichern.
   <br/>
   <br/>
   Mit diesen Informationen kann der Versicherte die Zugriffe auf seine Daten nachvollziehen und bei einem unberechtigten Zugriff ggfs. intervenieren.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103879|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19302">
 </a>
 <dl>
  <dt>
   A_19302 - E-Rezept-Fachdienst -Protokolleintrag Versichertenprotokoll leicht verständlich
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS in jedem zu tätigenden Eintrag des Protokolls für Versicherte einen lesbaren Text in einfacher Sprache (deutsch und englisch) erzeugen, der mindestens den Namen des Zugreifenden, die auslösende Operation und das Ergebnis der Operation umfasst, damit Versicherte ohne technisches Vorwissen den Inhalt des Zugriffsprotokolls verstehen können.
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20439">
 5.5 Löschfristen
</h3>
<p id="polarion_48">
 Der E-Rezept-Fachdienst soll eine Datensparsamkeit realisieren. Dafür werden nicht mehr benötigte Ressourcen, abgelaufene E-Rezepte und veraltete Kommunikationsnachrichten automatisch nach einer festen Frist gelöscht.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103561|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19252">
 </a>
 <dl>
  <dt>
   A_19252 - E-Rezept-Fachdienst - Löschfrist abgelaufener Rezepte
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS einen Task nach Ablauf der Löschfrist gemäß der folgenden Festlegung in TAB_eRPFD_007 automatisch löschen und das Löschen in einem AuditEvent für den Versicherten nachvollziehbar protokollieren, damit nicht mehr benötigte Informationen gelöscht sind.
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_007 Löschfristen
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=client1" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;">
    <tbody>
     <tr>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Task.status nach Statuswechsel
      </th>
      <th style="background-color: #F0F0F0;text-align: left;vertical-align: top;width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Löschfrist
      </th>
     </tr>
     <tr>
      <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       draft
      </td>
      <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       1 Tage nach Statuswechsel
      </td>
     </tr>
     <tr>
      <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       ready
      </td>
      <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       10 Tage nach Datum in
       <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
        Task.expiryDate
       </span>
      </td>
     </tr>
     <tr>
      <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       in-progress
      </td>
      <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       100 Tage nach Statuswechsel
      </td>
     </tr>
     <tr>
      <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       completed
      </td>
      <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       100 Tage nach Statuswechsel
      </td>
     </tr>
     <tr>
      <td style="width: 220px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       cancelled
      </td>
      <td style="width: 511px;height: 12px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       10 Tage nach Statuswechsel
      </td>
     </tr>
    </tbody>
   </table>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103562|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19254">
 </a>
 <dl>
  <dt>
   A_19254 - E-Rezept-Fachdienst - Löschen referenzierter Bundles
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS bei jedem Löschen eines Tasks alle referenzierten Bundles (QES-Datensatz, Quittungs-Bundle) ebenfalls löschen, damit die Informationen rund um ein gelöschtes E-Rezept ebenfalls entfernt werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103563|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19255">
 </a>
 <dl>
  <dt>
   A_19255 - E-Rezept-Fachdienst Löschen veralteter MedicationDispense
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS eine gespeicherte Ressource MedicationDispense nach 100 Tagen ab ihrem Erzeugungsdatum
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    MedicationDispense.whenHandedOver
   </span>
   automatisch löschen, damit Informationen zu veralteten und gelöschten Rezepten ebenfalls entfernt werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103564|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19253">
 </a>
 <dl>
  <dt>
   A_19253 - E-Rezept-Fachdienst - Löschfrist veraltete Nachrichten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS eine gespeicherte Ressource Communication ohne eine Referenz auf einen Task in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.basedOn
   </span>
   nach 100 Tagen ab ihrem Sendedatum
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.sent
   </span>
   und solche mit einer Referenz auf einen Task gemäß der Löschfrist in TAB_eRPFD_007 beim Löschen des Tasks automatisch löschen, damit nicht mehr relevante Nachrichten zu gelöschten Rezepten ebenfalls gelöscht werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103565|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19256">
 </a>
 <dl>
  <dt>
   A_19256 - E-Rezept-Fachdienst - Löschfrist veraltete Protokolleinträge
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS eine gespeicherte Ressource AuditEvent nach 3 Jahren ab dem Erzeugungsdatum
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    AuditEvent.recorded
   </span>
   löschen, damit veraltete Einträge nach Ende der regulären Aufbewahrungsfrist entfernt werden.
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20440">
 5.6 Sicherheit
</h3>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20441">
 5.6.1 Allgemeine Sicherheitsanforderungen
</h4>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103700|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19260">
 </a>
 <dl>
  <dt>
   A_19260 - E-Rezept-Fachdienst – Ausschluss unbekannter FdV-Versionsnummern von der Kommunikation
  </dt>
  <dd>
   Der
   <span id="polarion-comment:213">
   </span>
   E-Rezept-Fachdienst MUSS
   <span style="font-size: 10pt;line-height: 1.5;">
    an der Schnittstelle zum Internet die Produktidentifikation (Produktbezeichnung, Produktversion) des Clients
   </span>
   erkennen und
   <span style="font-size: 10pt;line-height: 1.5;">
    nicht zugelassene Produkte oder bestimmte Produktversionen von der Kommunikation mit dem E-Rezept-Fachdienst ausschließen zu können.
   </span>
   Der E-Rezept-Fachdienst MUSS in diesen Fällen eine entsprechende Fehlermeldung mit dem http-StatusCode 403
   <span style="font-size: 10pt;line-height: 1.5;">
    an den aufrufenden Client
   </span>
   geben.
   <span id="polarion-comment:225">
   </span>
  </dd>
 </dl>
</div>
<p id="polarion_179">
 <span style="font-size: 10pt;line-height: 1.5;">
 </span>
</p>
<p class="MsoNormal" id="polarion_107">
 <span style="font-size: 10pt;line-height: 1.5;">
  Hinweis: Der Ausschluss soll über ein Whitelisting gültiger Produktidentifikationen erfolgen.
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103701|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19261">
 </a>
 <dl>
  <dt>
   A_19261 - E-Rezept-Fachdienst – Ausschluss von FdV-Versionen
  </dt>
  <dd>
   Der
   <span id="polarion-comment:214">
   </span>
   Anbieter des E-Rezept-Fachdienstes MUSS ausschließlich auf Anweisung der gematik Clients
   <span style="font-size: 10pt;line-height: 1.5;">
    mit einer bestimmten Produktidentifikation
   </span>
   für die Kommunikation mit dem E-Rezept-Fachdienst zulassen.
   <span id="polarion-comment:226">
   </span>
  </dd>
 </dl>
</div>
<p id="polarion_180">
 <span style="font-size: 10pt;line-height: 1.5;">
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103706|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19266">
 </a>
 <dl>
  <dt>
   A_19266 - E-Rezept-Fachdienst - Berücksichtigung OWASP-Top-10-Risiken
  </dt>
  <dd>
   <span style="font-size: 10pt;line-height: 1.5;">
    Der E-Rezept-Fachdienst MUSS Maßnahmen zum Schutz vor den OWASP-Top-10-Risiken in der aktuellen Version umsetzen.
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103567|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19111">
 </a>
 <dl>
  <dt>
   A_19111 - E-Rezept-Fachdienst - Versionierung von Ressourcen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS eine Versionierung der FHIR-Ressource Task gemäß des Versionierungskonzepts [FHIR-ResVers] des FHIR-Standards umsetzen und in seinem CapabilityStatement ausweisen, damit für den Versicherten Zustandsänderungen nachvollziehbar und in der Versionshistorie des Tasks einsehbar sind.
  </dd>
 </dl>
</div>
<p id="polarion_51">
 Der E-Rezept-Fachdienst soll sich vor Anfragen, die nicht auf ein übliches Verhalten von Leistungserbringerinstitutionen und Versicherten während des Verordnungsprozesses schließen lassen, schützen. Diesen Anomalien wird mit einer Drosselung der Bearbeitungsgeschwindigkeit begegnet, um bspw. Brute-Force-Attacken auf das Erraten von AccessCodes für den Zugriff auf E-Rezept-Daten unattraktiv zu machen.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-111918|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20703">
 </a>
 <dl>
  <dt>
   A_20703 - E-Rezept-Fachdienst - Drosselung Brute-Force-Anfragen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS jede Antwort auf einen Funktionsaufruf, der einen AccessCode oder Secret enthält
   <br/>
   um den konfigurierbaren http-Response-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Warning
   </span>
   " (default "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    999 Throttling active
   </span>
   ") ergänzt und um ein konfigurierbares Zeitintervall (default: 500 Millisekunden) verzögert zurückschicken, sofern der erwartete AccessCode bzw Secret nicht mit dem übergebenen AccessCode bzw. Secret übereinstimmt, um BruteForce-Angriffe durch einen hohen Zeitaufwand unattraktiv zu machen.
   <span id="polarion-comment:235">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-111919|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20704">
 </a>
 <dl>
  <dt>
   A_20704 - E-Rezept-Fachdienst - Drosselung Rezeptfälschungen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS jede Antwort auf den Funktionsaufruf zum Aktivieren eines Tasks mittels Übergabe des QES-signierten Datensatzes um den konfigurierbaren http-Response-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Warning
   </span>
   " (default "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    999 Throttling active
   </span>
   ") ergänzt und um ein konfigurierbares Zeitintervall (default: 500 Millisekunden) verzögert zurückschicken, sofern die QES in der Prüfung während der Operation POST /Task/&lt;id&gt;/$activate als ungültig erkannt wird, um Angriffe durch Rezeptfälschungen durch einen hohen Zeitaufwand unattraktiv zu machen.
   <span id="polarion-comment:234">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-111920|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20705">
 </a>
 <dl>
  <dt>
   A_20705 - Anbieter E-Rezept-Fachdienst - Konfiguration und Deaktivierung Drosselung
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS die Funktion der Drosselung sowie die Konfiguration auf Weisung der gematik aktivieren oder deaktivieren bzw. die Konfigurationsparameter anpassen, um die Wirksamkeit des Mechanismus im Feld bei Bedarf zu verbessern.
   <span id="polarion-comment:233">
   </span>
  </dd>
 </dl>
</div>
<p id="polarion_124">
 Die gematik stellt mit der Prüfkarte eGK eine elektronische Identität zur Überprüfung verschiedener Anwendungsfälle in der TI und wird vorrangig von Dienstleistern vor Ort (DVOs) genutzt. Die Prüfkarte eGK ist nicht für die Nutzung im regulären Versorgungsalltag von Leistungserbringern oder Versicherten vorgesehen. Die folgenden Anforderungen verhindern eine Vermischung von Prüfaktivitäten mittels der Prüfkarte eGK und den Anwendungsfällen von Versicherten einer Krankenkasse.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112185|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20751">
 </a>
 <dl>
  <dt>
   A_20751 - E-Rezept-Fachdienst - Erkennen der Prüfidentität
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS eine eGK-Prüfkartenidentität anhand der Bildungsregel in Card-G2-A_3820 (X0000
   <span style="font-style: italic;">
    nnnn
   </span>
   P, mit
   <span style="font-style: italic;">
    nnnn
   </span>
   aus der Menge {0001 .. 5000} und P = Prüfziffer) für die KVNR der Prüfkarte eGK erkennen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112187|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20752">
 </a>
 <dl>
  <dt>
   A_20752 - E-Rezept-Fachdienst - Ausschluss Vertreterkommunikation von bzw. an Prüf-Identität
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Einstellen einer Communication-Ressource mit dem http-Status-Code 400 ablehnen wenn diese in den Absender-und Empfänger-Informationen eine Kombination von KVNR der Prüfkarte eGK und KVNR von Versicherten enthält.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112186|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20753">
 </a>
 <dl>
  <dt>
   A_20753 - E-Rezept-Fachdienst - Ausschluss Vertreterzugriff auf bzw. mittels Prüf-Identität
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS jeden Zugriff auf E-Rezepte mittels AccessCode (Vertreterzugriff) mit dem http-Status-Code 400 ablehnen, wenn sich aus dem Zugriff eine Kombination aus KVNR der Prüfkarte eGK und KVNR von Versicherten ergibt, d.h. Versicherte dürfen nicht auf Prüfrezepte und mit Prüfkarte eGK darf nicht auf Rezepte von Versicherten zugegriffen werden.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20442">
 5.6.2 Identifikation des Clientsystems
</h4>
<p id="polarion_34">
 Der E-Rezept-Fachdienst verwaltet und steuert den Einlöseprozess für elektronische Verordnungen. Damit kommt ihm eine Relevanz in der Medikamentenversorgung zu, die sich zum einen in einer hohen Verfügbarkeit und zum anderen in einem hohen Angriffspotential widerspiegelt. Zur Unterstützung der betrieblichen Überwachung des E-Rezept-Fachdienstes wird die Nutzung der im Feld befindlichen Clientsysteme protokolliert. Dabei ist der Zugriff auf die Schnittstellen des E-Rezept-Fachdienstes nur durch Primärsysteme der Leistungserbringer und zugelassene E-Rezept-FdVs zulässig. Der E-Rezept-Fachdienst erkennt die Clientsysteme anhand des User-Agent-Header eingehender HTTP-Requests und protokolliert diesen Wert.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108493|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20013">
 </a>
 <dl>
  <dt>
   A_20013 - E-Rezept-Fachdienst - Erkennung Clientsystem User-Agent
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das vom aufrufenden Nutzer verwendete Clientsystem anhand des im HTTP-Request enthaltenen Header-Feld "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    User-Agent
   </span>
   " gemäß [RFC7231] erkennen und in den Einträgen zur Performance-Rohdatenerfassung gemäß [gemSpec_Perf] protokollieren. Der E-Rezept-Fachdienst MUSS bei fehlendem
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    User-Agent
   </span>
   -Header den Request mit dem HTTP-Status-Code 400 beantworten, damit in der Betriebsüberwachung des E-Rezept-Fachdienstes die Nutzung unzulässiger Frontends erkannt werden kann.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20443">
 5.6.3 TSL und OCSP-Status
</h4>
<p id="polarion_121">
 Der E-Rezept-Fachdienst muss das E-Rezept-Frontend des Versicherten (E-Rezept-FdV) bei den Aufgaben unterstützen, regelmäßig die TSL-Aktualisierung vorzunehmen [gemSpec_eRp_FdV#A_20028] und Sperrinformationen für Zertifikate zu ermitteln [gemSpec_eRp_FdV#A_20032]. Die OCSP-Responder und der TSL-Dienst haben deutlich höhere SLAs in Bezug auf die Verfügbarkeit innerhalb der TI. Manche OCSP-Responder besitzen keine direkte Anbindung an das Internet (Komponenten-PKI, Kontext: Prüfung Identität vertrauenswürdige Ausführungsumgebung). Es wird damit auch möglich, bessere Aussagen über die Verfügbarkeit von E-Rezept-Anwendungsfällen zu treffen, weil weniger nicht-SLA-belegte Datenverbindungen für die Anwendungsfälle notwendig sind. (Wenn eine funktionierende Datenverbindung zwischen E-Rezept-FdV und E-Rezept-Fachdienst besteht, dann kann eine in [gemSpec_Perf] definierte Verfügbarkeit garantiert werden.) Aufgrund der Verwendung der Schnittstellen-Funktionalität über die schon etablierte TLS-Verbindung sind OCSP-Requests des E-Rezept-FdV nicht im Klartext im Internet sichtbar.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108508|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20023">
 </a>
 <dl>
  <dt>
   A_20023 - E-Rezept-Fachdienst - Bereitstellung TSL
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS folgende Vorgaben umsetzen:
   <br/>
   <ol>
    <li>
     Er MUSS mindestens einmal täglich aus der TI (TI-interne Verbindung) die "TSL(ECC-RSA)" und deren zugehörigen Hashwert aus der TI herunterladen.
    </li>
    <li>
     Er MUSS unter dem Pfadnamen "/TSL.xml" über das vom E-Rezept-FdV genutzte HTTPS-Interface die "TSL(ECC-RSA)" der TI zur Verfügung stellen (HTTP-GET, HTTP Content-Type: text/xml).
    </li>
    <li>
     Er MUSS unter dem Pfadnamen "/TSL.sha2" über das vom E-Rezept-FdV genutzte HTTPS-Interface den vom TSL-Dienst heruntergeladenen SHA-256 Hashwert der Datei TSL.xml aus Spiegelstrich 2 zur Verfügung stellen (HTTP Content-Type: text/plain, Hashwert als hexdump kodiert (64 Byte + Newline))
    </li>
   </ol>
  </dd>
 </dl>
</div>
<p id="polarion_111">
 Hinweise:
</p>
<ol id="polarion_122">
 <li>
  "TI-interne Verbindung" hat den Hintergrund, dass dort über SLAs eine ausreichende Verfügbarkeit gewährleistet ist.
 </li>
 <li>
  Hashwert der TSL.xml bedeutet der Hashwert der Datei TSL.xml, so wie sie vom TSL-Dienst der TI bereitgestellt wird und als wenn man die Datei als Binärdatei interpretiert (vgl. [gemSpec_TSL]).
 </li>
</ol>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108511|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20024">
 </a>
 <dl>
  <dt>
   A_20024 - E-Rezept-Fachdienst - Bereitstellung OCSP-Forwarder
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS folgende Vorgaben umsetzen:
   <br/>
   <ol>
    <li>
     Er MUSS unter dem in A_19411 in Tabelle: TAB_eRPFD_002 FQDN angegeben Pfadnamen für den key "ocspf" eine Möglichkeit zur Statusabfrage über das vom E-Rezept-FdV genutzte HTTPS-Interface zur Verfügung stellen (HTTP-POST, vgl. auch [RFC-6960, Appendix [gemSpec_PKI]).
    </li>
    <li>
     Er MUSS über die Schnittstelle aus Spiegelstrich 1 OCSP-Requests [RFC-6960] entgegen nehmen.
    </li>
    <li>
     Aus einem solchen OCSP-Request MUSS er aus dem issuerKeyHash [RFC-6960] die URL des entsprechenden OCSP-Responders in der TI ermitteln (Datengrundlage ist die TSL der TI) und den OCSP-Request an diese ermittelte URL weiterleiten.
    </li>
    <li>
     Er MUSS die erhaltenen OCSP-Response an das die OCSP-Anfrage stellende E-Rezept-FdV unverändert weiterreichen.
    </li>
   </ol>
  </dd>
 </dl>
</div>
<p id="polarion_123">
 Auf Anfrage stellt die gematik eine Beispielimplementierung für A_20024 Spiegelstrich 3 bereit.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108509|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20025">
 </a>
 <dl>
  <dt>
   A_20025 - E-Rezept-Fachdienst - Caching OCSP-Antworten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst KANN OCSP-Antworten aus A_20024 bis zu 4 Stunden cachen und bei einer entsprechend passenden OCSP-Anfrage, anstatt neu den OCSP-Responder anzufragen, die im Cache befindliche OCSP-Antwort ausliefern.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108510|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20026">
 </a>
 <dl>
  <dt>
   A_20026 - E-Rezept-Fachdienst - OCSP-Stapling
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS an der HTTPS-Schnittstelle zum Internet OCSP-Stapling [RFC-6066] unterstützen.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20444">
 5.6.4 Sicherheit der Netzübergänge
</h4>
<p id="polarion_31">
 Der E-Rezept-Fachdienst wird für Versicherte über das Internet erreichbar gemacht und für Leistungserbringer über das Netz der TI. Die folgenden Anforderungen beschreiben die für diese Netzübergänge erforderlichen Sicherheitsmechanismen. Für den Netzübergang aus dem Internet als Transportnetz zum E-Rezept-Fachdienst ist ein Paketfilter erforderlich.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107525|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19813">
 </a>
 <dl>
  <dt>
   A_19813 - E-Rezept-Fachdienst – Sicherung zum Transportnetz Internet durch Paketfilter
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS zum Transportnetz Internet durch einen Paketfilter (ACL) gesichert werden, welcher ausschließlich die erforderlichen Protokolle weiterleitet. Der Paketfilter des E-Rezept-Fachdienstes MUSS frei konfigurierbar sein auf der Grundlage von Informationen aus OSI-Layer 3 und 4, das heißt Quell- und Zieladresse, IP-Protokoll sowie Quell- und Zielport.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107526|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19814">
 </a>
 <dl>
  <dt>
   A_19814 - E-Rezept-Fachdienst – Platzierung des Paketfilters Internet
  </dt>
  <dd>
   Der Paketfilter des E-Rezept-Fachdienstes, zum Schutz in Richtung Transportnetz Internet, DARF NICHT physisch auf Systemen der VAU des E-Rezept-Fachdienstes oder dem vorgeschalteten TLS-terminierenden Load Balancer implementiert werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107527|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19815">
 </a>
 <dl>
  <dt>
   A_19815 - E-Rezept-Fachdienst – Richtlinien für den Paketfilter zum Internet
  </dt>
  <dd>
   Der Paketfilter des E-Rezept-Fachdienstes MUSS die Weiterleitung von IP-Paketen an der Schnittstelle zum Internet auf die nachfolgenden Protokolle beschränken:
   <br/>
   <ol>
    <li>
     HTTPS, und
    </li>
    <li>
     OCSP-Zugriffe für das OCSP-Stapling nach A_20026 (vgl. Hinweis nach A_19815), ggf. notwendige DNS Anfragen (und Antworten)
     <br/>
    </li>
   </ol>
   Ein Verbindungsaufbau aus dem E-Rezept-Fachdienst in Richtung Internet MUSS unterbunden werden, mit Ausnahme der Verbindungen aus Punkt 2 .
  </dd>
 </dl>
</div>
<p id="polarion_71">
 <span style="font-size: 10pt;line-height: 1.5;">
  Hinweis zu A_19815:
 </span>
</p>
<p id="polarion_115">
 <span style="font-size: 10pt;line-height: 1.5;">
  Der Anbieter des E-Rezept-Fachdienstes muss für seine HTTPS-Schnittstelle ein TLS-Zertifikat von einem durch das CAB-Forum zulässigen TSP erwerben (dessen CA-Zertifikat also über einen aktuellen Webbrowser prüfbar ist, vgl. A_19823). Für dieses TLS-Zertifikat fragt der E-Rezept-Fachdienst regelmäßig für das OCSP-Stapling nach A_20026 den OCSP-Responder des TSP nach dem Sperrstatus des TLS-Zertifikats. Als Antwort erhält der E-Rezept-Fachdienst eine OCSP-Response. Diese wird nach A_20022 geprüft und anschließend von der HTTPS-Schnittstelle verwendet (vgl.
  <a class="descriptionLink" href="https://tools.ietf.org/html/rfc6066#section-8" target="_top">
   https://tools.ietf.org/html/rfc6066#section-8
  </a>
  und bspw.
  <a class="descriptionLink" href="http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_stapling" target="_top">
   http://nginx.org/en/docs/http/ngx_http_ssl_module.html#ssl_stapling
  </a>
  ).
 </span>
</p>
<p id="polarion_116">
 <span style="font-size: 10pt;line-height: 1.5;">
  Um dies zu ermöglichen muss der Paketfilter entsprechende stateful-Firewall-Regeln gemäß A_19815 und A_20022 definieren.
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108506|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20022">
 </a>
 <dl>
  <dt>
   A_20022 - E-Rezept-Fachdienst - OCSP-Status für das OCSP-Stapling
  </dt>
  <dd>
   Der Paketfilter des E-Rezept-Fachdienstes MUSS bezüglich des OCSP-Stapling gemäß A_20026 folgende Vorgaben umsetzen:
   <br/>
   <ol>
    <li>
     Für das vom Anbieter des E-Rezept-Fachdienstes erworbene TLS-Zertifikat (vgl. Hinweis zu A_19815) MUSS der E-Rezept-Fachdienst initial die IP-Adresse (ggf. die IP-Adressen) des entsprechenden OCSP-Responsers ermitteln.
    </li>
    <li>
     Diese IP-Adresse(n) MÜSSEN gemäß A_19815 per stateful-Firewalling Verbindungen von der HTTPS-Schnittstelle an den OCSP-Responder erlaubt werden (Whitelisting).
    </li>
    <li>
     Gemäß OCSP-Stapling (
     <a class="descriptionLink" href="https://tools.ietf.org/html/rfc6066#section-8" target="_top">
      https://tools.ietf.org/html/rfc6066#section-8
     </a>
     ) MUSS der E-Rezept-Fachdienst regelmäßig eine OCSP-Response vom entsprechenden OCSP-Responder beziehen (Die Regelmäßigkeit wird vom zertifikatsausgebenden TSP und der Gültigkeitsdauer dessen OCSP-Responses bestimmt).
    </li>
    <li>
     Die OCSP-Responses MÜSSEN vom E-Rezept-Fachdienst geprüft werden (Signaturprüfung, CertID in der OCSP-Response passt zum angefragten Zertifikat). Falls eine der Prüfungen  ein nicht-positives Ergebnis liefert so MUSS die erhaltene OCSP-Response verworfen werden.
    </li>
    <li>
     Sollte die letzte im E-Rezept-Fachdienst vorhandene OCSP-Response zeitlich nicht mehr gültig sein (bspw. der OCSP-Responder im Internet war länger nicht erreichbar), so MUSS diese OCSP-Response verworfen werden und ein von einem Klienten (E-Rezept-FdV)
     <span style="font-size: 10pt;line-height: 1.5;">
      initiierter
     </span>
     TLS-Verbindungsaufbau der HTTPS-Schnittstelle ohne OCSP-Stapling durchgeführt werden.
    </li>
   </ol>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107537|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19824">
 </a>
 <dl>
  <dt>
   A_19824 - E-Rezept-Fachdienst – Verhalten bei Vollauslastung
  </dt>
  <dd>
   Der Paketfilter des E-Rezept-Fachdienstes MUSS so konfiguriert sein, dass bei Vollauslastung der Systemressourcen im E-Rezept-Fachdienst keine weiteren Verbindungen angenommen werden.
  </dd>
 </dl>
</div>
<p id="polarion_32">
 Durch die Zurückweisung von Verbindungen wird sichergestellt, dass Clients einen Verbindungsaufbau mit einer anderen Instanz des Fachdienstes versuchen, bei dem die erforderlichen Ressourcen zur Verfügung stehen.
</p>
<p id="polarion_46">
 Da der E-Rezept-Fachdienst die Verarbeitung der fachlichen Operationen in einer VAU ausführt, ist der Zugang zum Schutz dieser VAU zweistufig. Der E-Rezept-Fachdienst verfügt über einen Eingangspunkt (einen Load Balancer), an dem die TLS-Verbindung terminiert wird. Der Eingangspunkt wertet dann den HTTP-Header aus, um aus der Ziel-URL des Requests den für die Verarbeitung zu adressierenden Verarbeitungskontext zu ermitteln. An diesen Verarbeitungskontext wird der Request durch den Eingangspunkt weitergeleitet. In umgekehrter Richtung sendet der Eingangspunkt die Response des Verarbeitungskontextes über die TLS-Verbindung an den Client.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107404|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19720">
 </a>
 <dl>
  <dt>
   A_19720 - E-Rezept-Fachdienst – Verbindungen von Clients zu Verarbeitungskontexten der VAU über den Eingangspunkt
  </dt>
  <dd>
   Der Eingangspunkt des E-Rezept-Fachdienstes MUSS Verbindungen von Clients (Internet oder TI) ausschließlich über TLS akzeptieren. Er MUSS die TLS-Verbindung terminieren und HTTP Requests und Responses zwischen dem Client und dem für die jeweilige Sitzung zugeordneten Verarbeitungskontext der VAU vermitteln.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107536|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19823">
 </a>
 <dl>
  <dt>
   A_19823 - E-Rezept-Fachdienst – Richtlinien zum TLS-Verbindungsaufbau
  </dt>
  <dd>
   Der Eingangspunkt des E-Rezept-Fachdienstes MUSS sich beim TLS-Verbindungsaufbau über das Transportnetz gegenüber dem Client mit einem Extended Validation TLS-Zertifikat eines Herausgebers gemäß [CAB Forum] authentisieren. Das Zertifikat MUSS an die jeweilige Schnittstelle des Eingangspunkts für Primärsysteme und Frontends der Versicherten des E-Rezept-Fachdienstes gebunden werden, damit Clientsysteme beim TLS-Verbindungsaufbau eine vereinfachte Zertifikatsprüfung mit TLS-Standardbibliotheken durchführen können.
  </dd>
 </dl>
</div>
<p id="polarion_104">
</p>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20445">
 5.6.5 Vertrauenswürdige Ausführungsumgebung
</h4>
<p id="polarion_80">
 In diesem Abschnitt werden die Anforderungen an den E-Rezept-Fachdienst zur Umsetzung einer Vertrauenswürdigen Ausführungsumgebung (VAU) dargestellt. Die VAU dient der datenschutzrechtlich zulässigen und sicheren Verarbeitung von schützenswerten Klartextdaten innerhalb des E-Rezept-Fachdienstes sowie dem technischen Ausschluss der Profilbildung durch den Anbieter bzw. Betreiber. Die VAU stellt dazu Verarbeitungskontexte (d. h. Instanzen der VAU) bereit, in denen die Verarbeitung sensibler Daten im Klartext erfolgen kann. Diese Verarbeitungskontexte sind entsprechend zu schützen.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107363|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19683">
 </a>
 <dl>
  <dt>
   A_19683 - E-Rezept-Fachdienst – Umsetzung der fachlichen Operationen in einer Vertrauenswürdigen Ausführungsumgebung (VAU)
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die Verarbeitung aller fachlichen Operationen des Fachdienstes in einer Vertrauenswürdigen Ausführungsumgebung umsetzen.
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20446">
 5.6.5.1 Verarbeitungskontext
</h5>
<p id="polarion_83">
 Die Gesamtheit aus der für eine Klartextverarbeitung erforderlichen Software, dem für eine Klartextverarbeitung genutzten physikalischen System sowie den für die Integrität einer Klartextverarbeitung erforderlichen organisatorischen und physischen Rahmenbedingungen bildet den Verarbeitungskontext der Vertrauenswürdigen Ausführungsumgebung.
</p>
<p id="polarion_85">
 Zur Vertrauenswürdigen Ausführungsumgebung gehören neben den Verarbeitungskontexten alle für ihre Erreichbarkeit und betriebliche Steuerung erforderlichen Komponenten.
</p>
<p id="polarion_86">
 Der Verarbeitungskontext grenzt sich von allen weiteren, im betrieblichen Kontext beim Anbieter des E-Rezept-Fachdienstes vorhandenen Systemen und Prozessen dadurch ab, dass die sensiblen Klartextdaten von Komponenten innerhalb des Verarbeitungskontextes aus erreichbar sind oder sein können, während sie dies von außerhalb des Verarbeitungskontextes nicht sind. Sensible Daten verlassen den Verarbeitungskontext ausschließlich gemäß wohldefinierten (Zugriffs-)Regeln und in verschlüsselter Form.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107364|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19684">
 </a>
 <dl>
  <dt>
   A_19684 - E-Rezept-Fachdienst – Verarbeitungskontext der VAU
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sämtliche physikalischen Systemkomponenten sowie sämtliche Softwarekomponenten umfassen, deren Sicherheitseigenschaften sich auf den Schutz der personenbezogenen medizinischen Daten vor Zugriff durch Unbefugte bei ihrer Verarbeitung im Klartext auswirken können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107368|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19688">
 </a>
 <dl>
  <dt>
   A_19688 - E-Rezept-Fachdienst – Verschlüsselung von außerhalb des Verarbeitungskontextes der VAU gespeicherten Daten
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass sämtliche schützenswerten Daten vor einer Speicherung außerhalb der VAU verschlüsselt werden. Der Verarbeitungskontext MUSS dazu Schlüssel für nur jeweils ein individuelles E-Rezept (inkl. aller mit diesem E-Rezept verbundenen Daten) verwenden oder mindestens einmal pro Sekunde den verwendeten Schlüssel wechseln, so dass nur die innerhalb einer Sekunde neu angelegten E-Rezepte mit einem Schlüssel verschlüsselt werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107381|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19699">
 </a>
 <dl>
  <dt>
   A_19699 - E-Rezept-Fachdienst – Ableitung der Persistenzschlüssel durch ein HSM
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS die zur Verschlüsselung der persistierten E-Rezept-Daten verwendeten Schlüssel von einem HSM innerhalb der VAU abrufen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107382|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19700">
 </a>
 <dl>
  <dt>
   A_19700 - E-Rezept-Fachdienst - Ableitung der Persistenzschlüssel aus Merkmal der E-Rezepte
  </dt>
  <dd>
   Das HSM der VAU des E-Rezept-Fachdienstes MUSS eine Schnittstelle zur Ableitung von symmetrischen Schlüsseln für die Persistierung von E-Rezept-Daten bereitstellen. Das HSM der VAU des E-Rezept-Fachdienstes MUSS zur Ableitung des jeweiligen Schlüssels ein nach der ersten Erstellung unveränderliches Merkmal des E-Rezept-Datensatzes als Ableitungsparameter verwenden (z. B. den Zeitstempel der Registrierung von Rezept-ID und Access Code oder den Access Code selbst).
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107375|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19694">
 </a>
 <dl>
  <dt>
   A_19694 - E-Rezept-Fachdienst – Geschützte Weitergabe von Daten an autorisierte Nutzer durch die VAU
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass sämtliche schützenswerten Daten ausschließlich über sichere Verbindungen an autorisierte Nutzer weitergegeben werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103702|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19262">
 </a>
 <dl>
  <dt>
   A_19262 - E-Rezept-Fachdienst - Transportverschlüsselte Übertragung von Daten mit PVS
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt mit dem PVS kommuniziert.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103703|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19263">
 </a>
 <dl>
  <dt>
   A_19263 - E-Rezept-Fachdienst - Transportverschlüsselte Übertragung von Daten mit AVS
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt mit dem AVS kommuniziert.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103704|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19264">
 </a>
 <dl>
  <dt>
   A_19264 - E-Rezept-Fachdienst - Transportverschlüsselte Übertragung von Daten mit FdV
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt mit dem FdV kommuniziert.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103705|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19265">
 </a>
 <dl>
  <dt>
   A_19265 - E-Rezept-Fachdienst – vertrauliche Kommunikation
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sicherstellen, dass er nur transportverschlüsselt mit Komponenten außerhalb des  Verarbeitungskontextes kommuniziert.
  </dd>
 </dl>
</div>
<p class="MsoListParagraph" id="polarion_102">
 <span style="font-size: 10pt;line-height: 1.5;">
  Hinweis: für die Qualität der Transportverschlüsselung gelten die Anforderungen aus [gemSpec_Krypt].
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103707|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19267">
 </a>
 <dl>
  <dt>
   A_19267 - E-Rezept-Fachdienst - Authentisierung gegenüber Clients
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sich gegenüber Clients, die mit ihm kommunizieren, mittels der Fachdienstidentität oid_erp-vau mit Zertifikatsprofil C.FD.ENC (oid_fd_enc)
   <span id="polarion-comment:298">
   </span>
   ausweisen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107384|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19702">
 </a>
 <dl>
  <dt>
   A_19702 - E-Rezept-Fachdienst – Isolation zwischen Datenverarbeitungsprozessen mehrerer Verarbeitungskontexte der VAU
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS die in ihr ablaufenden Verarbeitungen für die Daten eines Verarbeitungskontextes von den Verarbeitungen für die Daten anderer Verarbeitungskontexte in solcher Weise trennen, dass mit technischen Mitteln ausgeschlossen wird, dass die Verarbeitungen eines Verarbeitungskontextes schadhaft auf die Verarbeitungen eines anderen Verarbeitungskontextes einwirken können.
  </dd>
 </dl>
</div>
<p id="polarion_69">
 <span style="font-style: italic;">
  Hinweis: Da der Verarbeitungskontext der VAU des E-Rezept-Fachdienstes für jede fachliche Operation neu aufgebaut werden muss, ist ein Low-Level-Mechanismus zur Kontextseparation aus Gründen der Performance bzw. Skalierung nicht zwingend vorgeschrieben. Der hier geforderte Separationsmechanismus kann daher auch als Server-Thread, Worker, o. Ä. ausgeführt sein, solange für den dadurch gebildeten Verarbeitungskontext die geforderte Separation nachgewiesen werden kann. Dies setzt voraus, dass die Umsetzung der Verarbeitungskontexte und der in ihnen ablaufenden Verarbeitungsvorgänge technisch möglichst einfach und nachvollziehbar gestaltet ist.
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107415|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19726">
 </a>
 <dl>
  <dt>
   A_19726 - E-Rezept-Fachdienst – Unabhängige Skalierung der Dienst-Ressourcen für verschiedene Anwendergruppen
  </dt>
  <dd>
   <span style="font-style: normal;">
    Die VAU des E-Rezept-Fachdienstes MUSS für die Anwendergruppen Leistungserbringer (E-Rezepte ausstellen, E-Rezepte einlösen) und Versicherte (E-Rezepte einsehen, zuweisen und löschen) auf jeweils getrennten physischen Servern betrieben werden, so dass eine Überlastung aufgrund außergewöhnlich hoher Aktivität einer Anwendergruppe (primär der Versicherten) keine Beeinträchtigung der Arbeitsfähigkeit der anderen Anwendergruppen (primär der Ärzte und Apotheker) zur Folge hat.
   </span>
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20447">
 5.6.5.2 Ausschluss von nicht autorisierten Zugriffen aus dem Betriebsumfeld
</h5>
<p id="polarion_89">
 Der Schutzbedarf der in der VAU verarbeiteten Klartextdaten erfordert den technischen Ausschluss von Zugriffen des Anbieters. Dies umfasst insbesondere Zugriffe durch Personen aus dem betrieblichen Umfeld des Anbieters.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107386|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19704">
 </a>
 <dl>
  <dt>
   A_19704 - E-Rezept-Fachdienst – Isolation der VAU von Datenverarbeitungsprozessen des Anbieters
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS die in ihren Verarbeitungskontexten ablaufenden Datenverarbeitungsprozesse von allen sonstigen Datenverarbeitungsprozessen des Anbieters trennen und damit gewährleisten, dass der Anbieter des E-Rezept-Fachdienstes vom Zugriff auf die in der VAU verarbeiteten schützenswerten Daten ausgeschlossen ist.
  </dd>
 </dl>
</div>
<p id="polarion_77">
 <span style="font-style: italic;">
  Hinweis: Für die Separation zwischen Verarbeitungskontexten und Verarbeitungsprozessen des Anbieters, die der betrieblichen Steuerung des Systems dienen, ist eine Low-Level Separation anzustreben, da - im Unterschied zur Separation zwischen Verarbeitungskontexten - hier technisch sehr verschiedene Aspekte getrennt werden müssen.
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107389|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19706">
 </a>
 <dl>
  <dt>
   A_19706 - vE-Rezept-Fachdienst – Ausschluss von Manipulationen an der Software der VAU
  </dt>
  <dd>
   <span style="font-style: normal;">
    Die VAU des E-Rezept-Fachdienstes MUSS eine Manipulation der eingesetzten Software erkennen und eine Ausführung der manipulierten Software verhindern.
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107388|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19707">
 </a>
 <dl>
  <dt>
   A_19707 - E-Rezept-Fachdienst – Ausschluss von Manipulationen an der Hardware der VAU
  </dt>
  <dd>
   <span style="font-style: italic;">
   </span>
   <span style="font-style: normal;">
    Die VAU des E-Rezept-Fachdienstes MUSS die Integrität der eingesetzten Hardware schützen und damit insbesondere Manipulationen an der Hardware durch den Anbieter des E-Rezept-Fachdienstes ausschließen.
   </span>
   <span style="font-style: italic;">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107390|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19708">
 </a>
 <dl>
  <dt>
   A_19708 - E-Rezept-Fachdienst – Kontinuierliche Wirksamkeit des Manipulationsschutzes der VAU
  </dt>
  <dd>
   <span style="font-style: normal;">
    Die VAU des E-Rezept-Fachdienstes MUSS den Ausschluss von Manipulationen an der Hardware und der Software durch den Anbieter des E-Rezept-Fachdienstes mit Mitteln umsetzen, deren dauerhafte und kontinuierliche Wirksamkeit gewährleistet werden kann.
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107391|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19709">
 </a>
 <dl>
  <dt>
   A_19709 - E-Rezept-Fachdienst – Kein physischer Zugang des Anbieters zu Systemen der VAU
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS mit technischen Mitteln sicherstellen, dass niemand, auch nicht der Anbieter des E-Rezept-Fachdienstes, während der Verarbeitung personenbezogener medizinischer Daten Zugriff auf physische Schnittstellen der Systeme erlangen kann, auf denen eine VAU ausgeführt wird.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107392|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19710">
 </a>
 <dl>
  <dt>
   A_19710 - E-Rezept-Fachdienst – Nutzdatenbereinigung vor physischem Zugang zu Systemen der VAU
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS mit technischen Mitteln sicherstellen, dass physischer Zugang zu Hardware-Komponenten der Verarbeitungskontexte nur erfolgen kann, nachdem gewährleistet ist, dass aus ihnen keine Nutzdaten extrahiert werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107393|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19711">
 </a>
 <dl>
  <dt>
   A_19711 - E-Rezept-Fachdienst – Private Schlüssel von Dienstzertifikaten im HSM
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die folgenden privaten Schlüssel in einem Hardware Security Module (HSM) erzeugen und anwenden:
   <ul>
    <li>
     TI-Fachdienst-Identität zur Authentisierung des Dienstes gegenüber dem Primärsystem des Leistungserbringers (TLS)
    </li>
    <li>
     TI-Fachdienst-Identität zur Authentisierung des Verarbeitungskontextes gegenüber dem Primärsystem des Leistungserbringers (sicherer Kanal auf Anwendungsebene),
    </li>
    <li>
     Privater Schlüssel des Schlüsselpaars zur Authentisierung des Verarbeitungskontextes gegenüber dem E-Rezept-Frontend des Versicherten (sicherer Kanal auf Anwendungsebene).
     <br/>
    </li>
   </ul>
   Die Prüftiefe des HSM MUSS dabei den in [A_19712] angegebenen Standards entsprechen.
  </dd>
 </dl>
</div>
<p id="polarion_97">
 <span style="font-style: italic;">
  Hinweis: Die TLS-TI-Fachdienst-Identität kann z. B. auf einem außerhalb der VAU betriebenen Load Balancer mit TLS-Terminierung verwendet werden. Hierfür muss dann ein HSM außerhalb der VAU verwendet werden.
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107394|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19712">
 </a>
 <dl>
  <dt>
   A_19712 - E-Rezept-Fachdienst – Einsatz zertifizierter HSM
  </dt>
  <dd>
   Der Anbieter des E-Rezept-Fachdienstes MUSS beim Einsatz eines HSM sicherstellen, dass dessen Eignung durch eine erfolgreiche Evaluierung nachgewiesen wurde. Als Evaluierungsschemata kommen dabei Common Criteria, ITSEC oder Federal Information Processing Standard (FIPS) in Frage.
   <br/>
   Die Prüftiefe MUSS mindestens
   <ol>
    <li>
     FIPS 140-2 Level 3,
    </li>
    <li>
     Common Criteria EAL 4+ mit hohem Angriffspotenzial oder
    </li>
    <li>
     ITSEC E3 der Stärke „hoch“ entsprechen.
    </li>
   </ol>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107395|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19713">
 </a>
 <dl>
  <dt>
   A_19713 - E-Rezept-Fachdienst – HSM-Kryptographieschnittstelle verfügbar nur für Instanzen der VAU
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS mit technischen Mitteln, die auch Manipulationen durch den Anbieter des E-Rezept-Fachdienstes ausschließen, gewährleisten, dass nur Instanzen der VAU Zugriff auf die Kryptographieschnittstelle des HSM zur Nutzung des privaten Schlüsselmaterials für ihre Dienstzertifikate erhalten können.
  </dd>
 </dl>
</div>
<p id="polarion_101">
 <span style="font-style: italic;">
  Hinweis: Falls die Verarbeitungskontexte als Threads, Workers, o. Ä. umgesetzt sind und daher gemeinsam in einem übergreifenden Anwendungsprozess ausgeführt werden, kann dieser Anwendungsprozess eine authentisierte Verbindung zur Kryptograhieschnittstelle des HSM herstellen und aufrecht erhalten, um darüber die Kryptographieschnittstelle des HSM den Verarbeitungskontexten (und nur diesen) lokal zur Verfügung zu stellen.
 </span>
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107396|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19714">
 </a>
 <dl>
  <dt>
   A_19714 - E-Rezept-Fachdienst – Sicherer Kanal vom Client zum Verarbeitungskontext der VAU
  </dt>
  <dd>
   <span style="font-style: normal;">
    Die VAU des E-Rezept-Fachdienstes MUSS den Aufbau eines vertraulichen und integritätsgeschützten Kommunikationskanals gemäß [gemSpec_Krypt#3.16] und [gemSpec_Krypt#7] zwischen einem Client und einem Verarbeitungskontext erzwingen, bevor der Verarbeitungskontext seine fachlichen Schnittstellen für den Client nutzbar macht.
   </span>
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20448">
 5.6.5.3 Konsistenz des Systemzustands, Logging und Monitoring
</h5>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107398|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19715">
 </a>
 <dl>
  <dt>
   A_19715 - E-Rezept-Fachdienst – Konsistenter Systemzustand des Verarbeitungskontextes der VAU
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS sicherstellen, dass ein konsistenter Zustand des Verarbeitungskontextes auch bei Bedienfehlern oder technischen Problemen immer erhalten bleibt bzw. wiederhergestellt werden kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107397|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19716">
 </a>
 <dl>
  <dt>
   A_19716 - E-Rezept-Fachdienst – Datenschutzkonformes Logging und Monitoring des Verarbeitungskontextes der VAU
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS die für den Betrieb eines Fachdienstes erforderlichen Logging- und Monitoring-Informationen in solcher Art und Weise erheben und verarbeiten, dass mit technischen Mitteln ausgeschlossen ist, dass dem Anbieter des E-Rezept-Fachdienstes oder Dritten vertrauliche oder zur Profilbildung geeignete Daten zur Kenntnis gelangen.
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20449">
 5.6.5.4 Client-Verbindungen zum Verarbeitungskontext
</h5>
<p id="polarion_120">
 Um Verbindungen vom E-Rezept-Frontend des Versicherten nach [gemSpec_eRp_FdV] zum Verarbeitungskontext zu ermöglichen, ist ein der VAU vorgelagertes Routing ausgehend von einem netztechnischen Eingangspunkt (z. B. in Form eines TLS-terminierenden Load Balancers) erforderlich. Der Eingangspunkt ist im Netzwerk der TI für das Primärsystem unter mindestens einer IP-Adresse/Port-Kombination erreichbar, die im Namensdienst der TI registriert sein muss. Der Eingangspunkt vermittelt die Verbindungen zwischen dem Client und dem jeweils benötigten Verarbeitungskontext.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107405|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19719">
 </a>
 <dl>
  <dt>
   A_19719 - E-Rezept-Fachdienst – Verarbeitungskontexte der VAU über gemeinsame Host-Adressen erreichbar
  </dt>
  <dd>
   Die VAU des E-Rezept-Fachdienstes MUSS ihre Verarbeitungskontexte über gemeinsame IP-Adressen und Ports des Eingangspunkts des Fachdienstes erreichbar machen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107411|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19724">
 </a>
 <dl>
  <dt>
   A_19724 - E-Rezept-Fachdienst – Identität des Verarbeitungskontextes für Clients
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS sich gegenüber Clients mittels der Fachdienstidentität
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    oid_erp-vau
   </span>
   mit Zertifikatsprofil
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    C.FD.ENC
   </span>
   ausweisen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107409|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19721">
 </a>
 <dl>
  <dt>
   A_19721 - E-Rezept-Fachdienst – Sicherer Kanal zum Verarbeitungskontext der VAU auf Inhaltsebene
  </dt>
  <dd>
   Der Eingangspunkt des E-Rezept-Fachdienstes MUSS Clients den Aufbau eines sicheren Kanals auf Inhaltsebene, d. h. einen Verbindungsaufbau gemäß [gemSpec_Krypt#3.16] und [gemSpec_Krypt#7], zum Verarbeitungskontext ermöglichen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107410|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19722">
 </a>
 <dl>
  <dt>
   A_19722 - E-Rezept-Fachdienst – Automatisierter Abbau des sicheren Kanals
  </dt>
  <dd>
   Der Verarbeitungskontext des E-Rezept-Fachdienstes MUSS den sicheren Kanal zu einem Client nach Abschluss einer fachlichen Operation (die aus mehreren Requests bestehen kann) abbauen, sodass anschließend keine Zugriffe dieses Clients auf den Verarbeitungskontext mehr möglich sind, ohne dass eine neue Verbindung aufgebaut wird.
  </dd>
 </dl>
</div>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20450">
 6 Funktionsmerkmale
</h2>
<p id="polarion_99">
 In diesem Abschnitt werden die vom E-Rezept-Fachdienst verwalteten Ressourcen mit ihren zulässigen Operationen und der Workflow des E-Rezepts spezifiziert. Dabei werden sowohl die relevanten HTTP-Operationen als auch die möglichen FHIR-Operationen auf Ressourcen-Endpunkte bzw. konkrete über eine &lt;id&gt; referenzierte Instanz vorgestellt. Die HTTP-Operationen dienen dabei der Zugriffssteuerung gemäß HTTP-Protokoll, um mit GET Daten von einem Server abzurufen und mittels POST Daten an einen Server zu schicken. Die FHIR-Operationen setzen in Kombination mit den HTTP-Operationen die Workflow-Steuerung um, wobei die entsprechenden FHIR-Operationen jeweils Zustandsänderungen triggern und bei den HTTP-Operationen POST vom Client Übergabeparameter erwarten und bei HTTP-GET ohne Übergabeparameter funktionieren.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-105616|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19536">
 </a>
 <dl>
  <dt>
   A_19536 - E-Rezept-Fachdienst - RESTful API
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS seine Schnittstellen für alle Zugriffe auf alle Datenobjekte und alle Ressourcen in einer RESTful API gemäß der FHIR-Spezifikation in
   <a class="descriptionLink" href="http://hl7.org/fhir/http.html" target="_top">
    http://hl7.org/fhir/http.html
   </a>
   der
   <span style="font-size: 10pt;line-height: 1.5;">
    Version v4.0.1 R4 umsetzen.
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-105621|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19537">
 </a>
 <dl>
  <dt>
   A_19537 - E-Rezept-Fachdienst - RESTful API MimeType fhir+xml
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS in seinen Schnittstellen für die Zugriffe durch Leistungserbringer und Leistungserbringerinstitutionen standardmäßig den MimeType
   <span style="font-size: 10pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;line-height: 1.5;">
    application/fhir+xml
   </span>
   akzeptieren und in Responses verwenden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-105619|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19538">
 </a>
 <dl>
  <dt>
   A_19538 - E-Rezept-Fachdienst - RESTful API MimeType fhir+json
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS in seinen Schnittstellen für die Zugriffe durch Versicherte standardmäßig den MimeType
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    <span style="font-size: 10pt;line-height: 1.5;">
     application/fhir+json
    </span>
   </span>
   akzeptieren und in Responses verwenden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-105620|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19539">
 </a>
 <dl>
  <dt>
   A_19539 - E-Rezept-Fachdienst - RESTful API MimeType Aufrufparameter
  </dt>
  <dd>
   Der
   <span id="polarion-comment:262">
   </span>
   E-Rezept-Fachdienst MUSS in seinen Schnittstellen einen von der Standardfestlegung abweichenden MimeType umsetzen, wenn der jeweilige Client eine entsprechende Anforderung in der Aufrufschnittstelle über den URL-Parameter
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    _format=fhir+xml
   </span>
   bzw.
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    _format=fhir+json
   </span>
   gemäß
   <a class="descriptionLink" href="http://hl7.org/fhir/http.html#general" target="_top">
    http://hl7.org/fhir/http.html#general
   </a>
   oder mittels des
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Accept
   </span>
   -Attributs im HTTP-Request-Header als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    application/fhir+xml
   </span>
   bzw.
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    application/fhir+json
   </span>
   anfordert, damit Clientsysteme ein für sie leichter verarbeitbares Format in der Antwort erhalten können.
   <span id="polarion-comment:263">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-109311|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20171">
 </a>
 <dl>
  <dt>
   A_20171 - E-Rezept-Fachdienst - RESTful API CapabilityStatement
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS an seinen Schnittstellen eine http-GET-Operation auf den Endpunkt /metadata erlauben, in welcher er ein CapabilityStatement gemäß
   <a class="descriptionLink" href="https://www.hl7.org/fhir/capabilitystatement.html" target="_top">
    https://www.hl7.org/fhir/capabilitystatement.html
   </a>
   veröffentlicht, welches die vom E-Rezept-Fachdienst verarbeiteten Ressourcen mit den zugehörigen http-Operationen der angebotenen REST-Schnittstelle auflistet:
   <br/>
   <ul>
    <li>
     Task – GET-, POST-Operation, FHIR-Operations für die Workflow-Steuerung und Einsicht durch den Versicherten
    </li>
    <li>
     MedicationDispense – GET-Operation für das Einsehen der Medikamentinformationen durch den Versicherten
    </li>
    <li>
     Communication – GET-, POST, DELETE-Operation für das Senden, Empfangen und Löschen von Nachrichten
    </li>
    <li>
     AuditEvent – GET-Operation für die Einsicht in Protokolleinträge durch den Versicherten
    </li>
    <li>
     Device – GET-Operation mit statischen Informationen zur serverseitigen Signatur
    </li>
   </ul>
   damit der Client eine Information über die FHIR-Kompatibilität zum Fachdienst erhält.
  </dd>
 </dl>
</div>
<p id="polarion_100">
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20451">
 6.1 Ressource Task
</h3>
<p id="polarion_90">
 Die FHIR-Resource Task [FHIR-TASK] bildet den Workflow für ein E-Rezept ab. Diese wird vom verordnenden Leistungserbringer mittels FHIR-Operationen
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  $create
 </span>
 und
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  $activate
 </span>
 im E-Rezept-Fachdienst erstellt. Der Versicherte kann die Ressource einsehen bzw. herunterladen und auf Wunsch mittels einer FHIR-Operation
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  $abort
 </span>
 löschen, die den Workflow abbricht. Die abgebende Apotheke greift ebenso wie der Verordnende ausschließlich über FHIR-Operationen
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  $accept
 </span>
 und
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  $close
 </span>
 zur Workflow-Steuerung auf einen Task zu.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103570|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19030">
 </a>
 <dl>
  <dt>
   A_19030 - E-Rezept-Fachdienst - unzulässige Operationen Task
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource Task mittels der HTTP-Operationen PUT, PATCH, HEAD und DELETE sowie POST ohne die Angabe einer gültigen FHIR-Operation unterbinden, damit keine unzulässigen Operationen auf den Rezeptdaten ausgeführt werden können.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20452">
 6.1.1 HTTP-Operation GET
</h4>
<p id="polarion_91">
 Der Zugriff mittels der HTTP-Operation GET steht ausschließlich für die Einsichtnahme in E-Rezepte durch den Versicherten bzw. einen Vertreter mit Wissen um den AccessCode bzw. einen Apotheker mit Wissen um das Secret zur Verfügung. Die GET-Operation ohne Referenz einer FHIR-Operation führt zu keiner Statusänderung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103572|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19113">
 </a>
 <dl>
  <dt>
   A_19113 - E-Rezept-Fachdienst - Rollenprüfung Versicherter oder Apotheker liest Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task
   </span>
   und auf einen konkreten über &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   (ohne die Referenz einer FHIR-Operation) sicherstellen, dass ausschließlich Versicherte oder Apotheken in einer der Rollen
   <br/>
   <ul>
    <li>
     oid_versicherter
    </li>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit E-Rezepte nicht durch Unberechtigte ausgelesen werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103573|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19115">
 </a>
 <dl>
  <dt>
   A_19115 - E-Rezept-Fachdienst - Filter Tasks auf KVNR des Versicherten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task
   </span>
   die dem Versicherten zugeordneten Task-Ressourcen anhand der KVNR des Versicherten aus dem ACCESS_TOKEN im "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   "-Header des HTTP-Requests identifizieren, die in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.for
   </span>
   mit dem Value-Set
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   die entsprechende KVNR des begünstigten Patienten referenziert haben, damit ausschließlich Versicherte ihre eigenen E-Rezepte einsehen können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103574|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19116">
 </a>
 <dl>
  <dt>
   A_19116 - E-Rezept-Fachdienst - Prüfung AccessCode bei KVNR-Missmatch
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf einen einzelnen
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   und Ungleichheit der KVNR des Aufrufenden (KVNR des ACCESS_TOKEN im "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   "-Header des HTTP-Requests UNGLEICH KVNR in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.for
   </span>
   mit Value-Set
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   ) prüfen, ob der im HTTP-Request-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    X-AccessCode
   </span>
   " oder URL-Parameter "?ac=..." übergebene AccessCode gleich dem AccessCode in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier
   </span>
   ist, damit auch Vertreter in Kenntnis des AccessCodes ein einzelnes E-Rezept einsehen können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103575|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19129">
 </a>
 <dl>
  <dt>
   A_19129 - E-Rezept-Fachdienst - Rückgabe Task inkl. Bundle im Bundle Versicherter
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task
   </span>
   oder auf einen einzelnen
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   die gültige Ergebnisliste der Task-Ressourcen um das jeweils referenzierte, serverseitig signierte E-Rezept-Bundle aus
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.input
   </span>
   <span style="font-family: Arial, Helvetica;">
    mit Codingsystem
   </span>
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    <a class="descriptionLink" href="https://gematik.de/fhir/CodeSystem/Documenttype" target="_top">
     https://gematik.de/fhir/CodeSystem/Documenttype
    </a>
    = 2
   </span>
   und sofern vorhanden aus
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.output
   </span>
   als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    search.include
   </span>
   im Ergebnis-Bundle ergänzen und die Ergebnismenge Task[s] + E-Rezept-Bundle[s] an den Aufrufer zurückgeben, damit der Versicherte eine vollständige Einsicht in den Task und den signierten Verordnungsdatensatz und bei Vorhandensein die Quittung für eigene Dokumentationszwecke erhält.
  </dd>
 </dl>
</div>
<p id="polarion_42">
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-111913|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20702">
 </a>
 <dl>
  <dt>
   A_20702 - E-Rezept-Fachdienst - Keine Einlöseinformationen in unbekannten Clients
  </dt>
  <dd>
   <span style="font-size: 10pt;line-height: 1.5;">
    Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     /Task
    </span>
    oder auf einen einzelnen
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     /Task/&lt;id&gt;
    </span>
    ausschließlich Primärsystemen und solchen Clients die AccessCode Information (
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     Task.identifier
    </span>
    mit
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     system="
     <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/AccessCode" target="_top">
      https://gematik.de/fhir/Namingsystem/AccessCode
     </a>
     "
    </span>
    ) in den Task-Ressourcen zurückgeben, welche anhand der mitgeteilten, gültigen Produktidentifikation als zulässige Clients erkannt werden.
    <span id="polarion-comment:228">
    </span>
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103576|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19226">
 </a>
 <dl>
  <dt>
   A_19226 - E-Rezept-Fachdienst - Rückgabe Task inkl. Bundle im Bundle Apotheker
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf einen einzelnen Task mittels "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;?secret=...
   </span>
   " durch einen Apotheker den Task, sofern er den Status "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    completed
   </span>
   " hat, um das referenzierte, serverseitig signierte Quittungs-Bundle aus
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.output
    <span style="font-family: Arial, Helvetica;">
     mit Codingsystem
    </span>
    <a class="descriptionLink" href="https://gematik.de/fhir/CodeSystem/Documenttype" target="_top">
     https://gematik.de/fhir/CodeSystem/Documenttype
    </a>
    = 3
   </span>
   als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    search.include
   </span>
   im Ergebnis-Bundle ergänzen und die Ergebnismenge Task + Quittungs-Bundle an den Apotheker zurückgeben, damit ein Apotheker, der ein konkretes E-Rezept beliefert hat, bei Bedarf genau dieses belieferte E-Rezept inkl. der Quittung erneut abrufen kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-107040|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19569">
 </a>
 <dl>
  <dt>
   A_19569 - E-Rezept-Fachdienst - Suchparameter Task
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task
   </span>
   eine Suche nach einem Task mit einer konkreten Task.id und
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    _revinclude
   </span>
   der Ressource
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    AuditEvent:entity:what
   </span>
   gemäß
   <a class="descriptionLink" href="https://www.hl7.org/fhir/search.html#revinclude" target="_top">
    https://www.hl7.org/fhir/search.html#revinclude
   </a>
   und
   <a class="descriptionLink" href="https://www.hl7.org/fhir/task.html#search" target="_top">
    https://www.hl7.org/fhir/task.html#search
   </a>
   zulassen, sodass der Versicherte zu einem Task alle zugehörigen Protokolleinträge abrufen kann.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20453">
 6.1.2 HTTP-Operation POST
</h4>
<p id="polarion_92">
 Der Zugriff auf einen Task mittels der HTTP-Operation POST erfolgt immer in Verbindung mit dem Aufruf einer FHIR-Operation, die den Workflow des Tasks steuert. Je nach Anwendungsfall erfolgt der POST-Aufruf auf den Ressourcen-Endpunkt /Task oder eine konkrete über die ID referenzierte Task-Ressource /Task/&lt;id&gt;.
</p>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20454">
 6.1.2.1 POST /Task/$create
</h5>
<p id="polarion_93">
 Die FHIR-Operation $create erzeugt einen neuen FHIR-Task für ein E-Rezept. Diese Operation steht ausschließlich verordnenden Leistungserbringern zur Verfügung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103579|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19018">
 </a>
 <dl>
  <dt>
   A_19018 - E-Rezept-Fachdienst - Rollenprüfung Verordnender stellt Rezept ein
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks mittels HTTP-POST/$create-Operation die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufenden im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen und sicherstellen, dass ausschließlich verordnende Leistungserbringer in der Rolle
   <br/>
   <ul>
    <li>
     oid_arzt
    </li>
    <li>
     oid_zahnarzt
    </li>
    <li>
     oid_praxis_arzt
    </li>
    <li>
     oid_zahnarztpraxis
    </li>
    <li>
     oid_praxis_psychotherapeut
    </li>
    <li>
     oid_krankenhaus
    </li>
   </ul>
   die Operation im Fachdienst aufrufen dürfen, damit E-Rezepte nicht durch zur Verordnung Unberechtigte eingestellt werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103580|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19257">
 </a>
 <dl>
  <dt>
   A_19257 - E-Rezept-Fachdienst - Schemavalidierung Rezept anlegen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die im Body der HTTP-POST-Operation auf die Ressource Task übertragenen Parameter gegen das Schema
   <a class="descriptionLink" href="http://gematik.de/fhir/OperationDefinition/CreateOperationDefinition" target="_top">
    http://gematik.de/fhir/OperationDefinition/CreateOperationDefinition
   </a>
   prüfen und bei Nicht-Konformität das Anlegen der Ressource im Fachdienst mit dem http-Status-Code 400 beantworten, damit kein Schadcode und keine "fachfremden" Daten in den E-Rezept-Fachdienst hochgeladen werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103581|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19112">
 </a>
 <dl>
  <dt>
   A_19112 - E-Rezept-Fachdienst - Parametrierung Task für Workflow-Typ
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks mittels HTTP-POST/$create-Operation den Parameter workFlowType (Rezepttyp) aus dem HTTP-Body des POST-Requests entnehmen, als Attribut
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.extension:flowType
   </span>
   des zu erstellenden Tasks verwenden und bei Fehlen bzw. Nicht-Konformität des Parameters den Request als unzulässig abweisen, damit auf Basis dieser Parameter ausschließlich gültige Workflows gestartet werden können und dem Versicherten bei Einsicht des Tasks der Weg in entweder eine Apotheke oder ein Sanitätshaus oder eine andere zuständige Einrichtung gewiesen werden kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103582|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19214">
 </a>
 <dl>
  <dt>
   A_19214 - E-Rezept-Fachdienst - Ergänzung Performer-Typ für Einlöseinstitutstyp
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks das Feld
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.performerType
   </span>
   aus dem übergebenen, gültigen Parameter
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.extension:flowType
   </span>
   gemäß der Prozessparameter [gemSpec_DM_eRp#19445] übernehmen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103583|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19019">
 </a>
 <dl>
  <dt>
   A_19019 - E-Rezept-Fachdienst - Generierung Rezept-ID
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Anlegen eines neuen Tasks eine Rezept-ID gemäß der Bildungsregel [gemSpec_DM_eRp#19217] generieren und als Identifier mit Namingsystem
   <a class="descriptionLink" href="https://gematik.de/fhir/NamingSystem/PrescriptionID" target="_top">
    https://gematik.de/fhir/NamingSystem/PrescriptionID
   </a>
   <span id="polarion-comment:17">
   </span>
   dem Task hinzufügen und sicherstellen, dass diese Rezept-ID innerhalb von 11 Jahren nach ihrer Erzeugung nicht erneut vergeben wird, damit es innerhalb der Aufbewahrungsfrist der Abrechnungsdaten bei den Krankenkassen zu keinen Dubletten kommt.
   <span id="polarion-comment:296">
   </span>
  </dd>
 </dl>
</div>
<p id="polarion_108">
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103584|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19021">
 </a>
 <dl>
  <dt>
   A_19021 - E-Rezept-Fachdienst - Generierung AccessCode
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Erzeugen eines Tasks mittels HTTP-POST/$create-Operation eine 256 Bit Zufallszahl mit einer Mindestentropie von 120 Bit erzeug
   <span style="font-size: 10pt;line-height: 1.5;">
    en, hexadezimal kodieren ([0-9a-f]{64})
   </span>
   und diese im zu speichernden Task als externe ID in Task.identifier:AccessCode als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/AccessCode" target="_top">
    https://gematik.de/fhir/Namingsystem/AccessCode
   </a>
   hinzufügen, damit nachfolgende Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103585|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19114">
 </a>
 <dl>
  <dt>
   A_19114 - E-Rezept-Fachdienst - Status draft
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die zulässige Anlage eines Tasks mittels HTTP-POST/$create-Operation im Status
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = draft
   </span>
   vollziehen und beim erfolgreichen Abschluss der Operation die angelegte Ressource Task im HTTP-Body der HTTP-Response zurückgeben, damit der verordnende Leistungserbringer die generierte Rezept-ID für die QES verwenden kann.
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20455">
 6.1.2.2 POST /Task/&lt;id&gt;/$activate
</h5>
<p id="polarion_94">
 Die FHIR-Operation $activate startet einen E-Rezept-Workflow eines zuvor unter einer &lt;id&gt; angelegten neuen Tasks. Diese Operation steht ausschließlich verordnenden Leistungserbringern zur Verfügung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103587|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19022">
 </a>
 <dl>
  <dt>
   A_19022 - E-Rezept-Fachdienst - Rollenprüfung Verordnender aktiviert Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks für ein E-Rezept mittels HTTP-POST/$activate-Operation auf den in der URL referenzierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   sicherstellen, dass ausschließlich verordnende Leistungserbringer in der Rolle
   <br/>
   <ul>
    <li>
     oid_arzt
    </li>
    <li>
     oid_zahnarzt
    </li>
    <li>
     oid_praxis_arzt
    </li>
    <li>
     oid_zahnarztpraxis
    </li>
    <li>
     oid_praxis_psychotherapeut
    </li>
    <li>
     oid_krankenhaus
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit E-Rezepte nicht durch Unberechtigte eingestellt werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103588|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19024">
 </a>
 <dl>
  <dt>
   A_19024 - E-Rezept-Fachdienst - Prüfung AccessCode Rezept aktualisieren
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate den im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    X-AccessCode
   </span>
   " übertragenenen AccessCode gegen den im referenzierten Task gespeicherten AccessCode Task.identifier:AccessCode als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/AccessCode" target="_top">
    https://gematik.de/fhir/Namingsystem/AccessCode
   </a>
   und den Status des Tasks auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = draft
   </span>
   prüfen und bei Ungleichheit oder Fehlen des HTTP-Headers die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen.
   <span id="polarion-comment:290">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103589|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19020">
 </a>
 <dl>
  <dt>
   A_19020 - E-Rezept-Fachdienst - Schemavalidierung Rezept aktivieren
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS den im Aufrufparameter der HTTP-POST-Operation
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$activate
   </span>
   übergebenen FHIR-Operationsparameter des QES-Datensatzes als PKCS#7-Datei einer Enveloping CAdES-Signatur entgegennehmen und verarbeiten und bei Fehlen oder ungültiger ASN.1 Datenstruktur die Weiterverarbeitung im Fachdienst mit dem http-Status-Code 400 beantworten, damit kein Schadcode und keine "fachfremden" Daten in den E-Rezept-Fachdienst hochgeladen werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103590|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19025">
 </a>
 <dl>
  <dt>
   A_19025 - E-Rezept-Fachdienst - QES prüfen Rezept aktualisieren
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate die qualifizierte Signatur des QES-Datensatzes gemäß [ETSI_QES] prüfen und bei nicht gültiger qualifizierter Signatur die Operation mit Status 400 abbrechen bzw. bei gültiger Signatur den Datensatz als PKCS#7-Datei sicher speichern und in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.input
   </span>
   mit Codingsystem
   <a class="descriptionLink" href="https://gematik.de/fhir/CodeSystem/Documenttype" target="_top">
    https://gematik.de/fhir/CodeSystem/Documenttype
   </a>
   = 1 über eine interne, eindeutige UUID referenzieren, damit der nachfolgende Workflow ausschließlich auf Basis medizinisch korrekter und vom Leistungserbringer mittels Signatur freigegebener Daten erfolgt.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-109250|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20159">
 </a>
 <dl>
  <dt>
   A_20159 - E-Rezept-Fachdienst - QES Prüfung Signaturzertifikat des HBA
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das QES-Signaturzertifikat C.HP.QES in der Signatur des übergebenen QES-Datensatzes gemäß [gemSpec_PKI#TUC_PKI_030] mit folgenden Parametern auf Gültigkeit prüfen:
   <br/>
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_006 Parameter Prüfung Signaturzertifikat QES des HBA
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 155px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       Parameter
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 577px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
      </th>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       Zertifikat
      </td>
      <td style="text-align: left;vertical-align: top;width: 577px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       Signaturzertifikat des HBA (eingebettet in Signatur-Objekt des QES-Datensatzes) C.HP.QES
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       Referenzzeitpunkt
      </td>
      <td style="text-align: left;vertical-align: top;width: 577px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       &lt;Zeitpunkt der QES.Erstellung gemäß
       <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
        signingTime
       </span>
       im QES-Datensatz&gt;
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       Offline-Modus
      </td>
      <td style="text-align: left;vertical-align: top;width: 577px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       nein
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       OCSP-Response
      </td>
      <td style="text-align: left;vertical-align: top;width: 577px;height: 12px;border: 1px solid #CCCCCC;padding: 5px;">
       (leer)
      </td>
     </tr>
    </tbody>
   </table>
   <br/>
   und darf die OCSP-Response für die Abfrage des Zertifikatsstatus für 12 Stunden zwischenspeichern.
   <br/>
   Das Signaturzertifikat muss anhand der Zertifikatsprüfung für [mathematisch gültig UND zeitlich gültig UND online gültig ] befunden werden und der HTTP-Request andernfalls mit dem HTTP-Status-Code 400 abgelehnt werden, damit sichergestellt wird, dass ausschließlich E-Rezepte verwaltet werden die von einer gültigen, nicht gesperrten Heilberufsidentität eines HBA signiert wurden.
   <br/>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103591|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19225">
 </a>
 <dl>
  <dt>
   A_19225 - E-Rezept-Fachdienst - QES durch berechtigte Berufsgruppe
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die Aktivierung eines E-Rezept-Tasks mit dem HTTP-Status-Code 400 abbrechen, wenn die QES gemäß der professionOID des Signaturzertifikats des Signierers nicht von einer Berufsgruppe ausgestellt wurde, die der folgenden professionOID entspricht:
   <br/>
   <ul>
    <li>
     oid_arzt
    </li>
    <li>
     oid_zahnarzt
    </li>
   </ul>
   damit nur solche Leistungserbringer ein signiertes E-Rezept einstellen, die zur Verordnung von Medikamenten ermächtigt sind.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-108465|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19999">
 </a>
 <dl>
  <dt>
   A_19999 - E-Rezept-Fachdienst - Ergänzung PerformerTyp für Einlöseinstitutstyp
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks aus dem Feld
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.performerType
   </span>
   die Prozessparameter des Tasks gemäß [gemSpec_DM_eRp#19445] ableiten und befüllen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103592|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19127">
 </a>
 <dl>
  <dt>
   A_19127 - E-Rezept-Fachdienst - Übernahme der KVNR des Patienten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS im Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$activate und bei gültiger qualifizierter elektronischer Signatur die KVNR des Patienten dem Identifier
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   der Patient-Ressource im signierten E-Rezept-Bundle gemäß
   <a class="descriptionLink" href="https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle" target="_top">
    https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle
   </a>
   des QES-Datensatzes entnehmen und diese als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Identifier
   </span>
   mit dem Value-Set
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   dem Task in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.for
   </span>
   hinzufügen, damit ausschließlich eine gültige, vom Arzt signierte Patientenreferenz im Workflow verwendet wird.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103593|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19128">
 </a>
 <dl>
  <dt>
   A_19128 - E-Rezept-Fachdienst - Status aktivieren
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die zulässige Aktivierung eines Tasks mittels /Task/&lt;id&gt;/$activate-Operation im Status
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = ready
   </span>
   vollziehen und bei erfolgreichem Abschluss der Operation die Ressource Task im HTTP-Body der HTTP-Response zurückgeben, damit der verordnende Leistungserbringer über den erfolgreichen Abschluss der Operation in Kenntnis gesetzt wird.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103594|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19029">
 </a>
 <dl>
  <dt>
   A_19029 - E-Rezept-Fachdienst - Serversignatur Rezept aktivieren
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aktivieren eines Tasks mittels /Task/&lt;id&gt;/$activate das im QES-Datensatz enthaltene
   <br/>
   FHIR-E-Rezept-Bundle vom Profil
   <a class="descriptionLink" href="https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle" target="_top">
    https://fhir.kbv.de/StructureDefinition/KBV_PR_ERP_Bundle
   </a>
   in ein Bundle gleichen Typs in JSON-Repräsentation transformieren, einen neuen Identifier für
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Bundle.id
   </span>
   als UUID generieren, das Bundle entsprechend der Kanonisierungsregeln
   <a class="descriptionLink" href="http://hl7.org/fhir/canonicalization/json#static" target="_top">
    http://hl7.org/fhir/canonicalization/json#static
   </a>
   normalisieren und mit der Signaturidentität des Fachdienstes ID.FD.SIG gemäß [FHIR-Sig] signieren und das signierte Bundle mit Referenz in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.input
   </span>
   <span style="font-family: Arial, Helvetica;">
    mit Codingsystem
   </span>
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    <a class="descriptionLink" href="https://gematik.de/fhir/CodeSystem/Documenttype" target="_top">
     https://gematik.de/fhir/CodeSystem/Documenttype
    </a>
    = 2
   </span>
   speichern, damit der Versicherte einen Nachweis über die Integrität der gespeicherten Daten einsehen kann.
  </dd>
 </dl>
</div>
<p id="polarion_47">
</p>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20456">
 6.1.2.3 POST /Task/&lt;id&gt;/$accept
</h5>
<p id="polarion_151">
 Die FHIR-Operation $accept weist ein E-Rezept einem abgebenden Leistungserbringer (bzw. der Apotheke als Leistungserbringerinstitution) als "in Abgabe" befindlich über die &lt;id&gt; referenzierten Tasks zu. Diese Operation steht ausschließlich abgebenden Leistungserbringern in Kenntnis des AccessCodes zur Verfügung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103596|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19166">
 </a>
 <dl>
  <dt>
   A_19166 - E-Rezept-Fachdienst - Rollenprüfung Abgebender ruft  Rezept ab
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Abrufen eines Tasks für ein E-Rezept mittels HTTP-POST/$accept-Operation auf den in der URL referenzierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   sicherstellen, dass ausschließlich abgebende Leistungserbringer in der Rolle
   <br/>
   <ul>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit E-Rezepte nicht durch Unberechtigte abgerufen werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103597|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19167">
 </a>
 <dl>
  <dt>
   A_19167 - E-Rezept-Fachdienst - Prüfung AccessCode Rezept abrufen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept den im URL-Parameter "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    ?ac=...
   </span>
   " übertragenenen AccessCode gegen den im referenzierten Task gespeicherten AccessCode
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier:AccessCode
   </span>
   als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/AccessCode" target="_top">
    https://gematik.de/fhir/Namingsystem/AccessCode
   </a>
   prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit Zugriffe auf diesen Datensatz nur durch Berechtigte in Kenntnis des AccessCodes erfolgen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103598|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19168">
 </a>
 <dl>
  <dt>
   A_19168 - E-Rezept-Fachdienst - Rezept bereits in Abgabe oder Bearbeitung
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept die Operation mit dem HTTP-Fehlercode 409 abbrechen, wenn der Status
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = completed, Task.status = in-progress
   </span>
   oder
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = draft
   </span>
   ist, damit ein bereits in Abgabe befindliches oder beliefertes E-Rezept nicht durch eine zweite Apotheke bearbeitet werden kann.
   <span id="polarion-comment:286">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103599|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19169">
 </a>
 <dl>
  <dt>
   A_19169 - E-Rezept-Fachdienst - Generierung Secret, Statuswechsel in Abgabe und Rückgabewert
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept den Status des Tasks auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = in-progress
   </span>
   setzen, eine 256 Bit Zufallszahl mit einer Mindestentropie von 120 Bit erzeug
   <span style="font-size: 10pt;line-height: 1.5;">
    en, hexadezimal kodieren ([0-9a-f]{64})
   </span>
   und diese im zu speichernden Task als externe ID in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier:Secret
   </span>
   als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/Secret" target="_top">
    https://gematik.de/fhir/Namingsystem/Secret
   </a>
   hinzufügen und den Task im Bundle mit dem in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.input
   </span>
   <span style="font-family: Arial, Helvetica;">
    mit Codingsystem
   </span>
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    <a class="descriptionLink" href="https://gematik.de/fhir/CodeSystem/Documenttype" target="_top">
     https://gematik.de/fhir/CodeSystem/Documenttype
    </a>
    = 1
   </span>
   referenzierten QES-Datensatz als Binary-Ressource
   <a class="descriptionLink" href="https://www.hl7.org/fhir/binary.html" target="_top">
    https://www.hl7.org/fhir/binary.html
   </a>
   an den Aufrufer zurückgeben, damit das E-Rezept für die nachfolgende Bearbeitung durch den abrufenden Apotheker reserviert ist.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103600|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19149">
 </a>
 <dl>
  <dt>
   A_19149 - E-Rezept-Fachdienst - Prüfung Datensatz zwischenzeitlich gelöscht
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$accept die Operation mit dem HTTP-Fehlercode 410 abbrechen, wenn der referenzierte /Task/&lt;id&gt; existiert, jedoch kein AccessCode im Task.identifier:AccessCode als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/AccessCode" target="_top">
    https://gematik.de/fhir/Namingsystem/AccessCode
   </a>
   vorhanden ist oder der Status
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = cancelled
   </span>
   ist, damit ein Apotheker den Versicherten über die zwischenzeitliche Löschung des Datensatzes in Kenntnis setzen kann.
  </dd>
 </dl>
</div>
<p id="polarion_169">
</p>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20457">
 6.1.2.4 POST /Task/&lt;id&gt;/$reject
</h5>
<p id="polarion_152">
 Die FHIR-Operation $reject nutzt die abgebende LEI, um ein E-Rezept zurück zu geben. Anschließend kann das E-Rezept von einer anderen Apotheke in Kenntnis des AccessCodes und der ID des Tasks wieder abgerufen werden oder der Versicherte das E-Rezept bei Bedarf löschen.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103602|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19170">
 </a>
 <dl>
  <dt>
   A_19170 - E-Rezept-Fachdienst - Rollenprüfung Abgebender ruft Rezept ab
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zurückweisen eines Tasks für ein E-Rezept mittels HTTP-POST/$reject-Operation auf den in der URL referenzierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   sicherstellen, dass ausschließlich abgebende Leistungserbringer in der Rolle
   <br/>
   <ul>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit das E-Rezept nicht durch einen Unberechtigten zurückgewiesen werden kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103603|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19171">
 </a>
 <dl>
  <dt>
   A_19171 - E-Rezept-Fachdienst - Prüfung Secret Rezept zurückweisen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zugriff auf einen Task mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$reject das im URL-Parameter "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    ?secret=...
   </span>
   " übertragene Secret gegen das im referenzierten Task gespeicherte Secret
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier:Secret
   </span>
   als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/Secret" target="_top">
    https://gematik.de/fhir/Namingsystem/Secret
   </a>
   und auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = in-progress
   </span>
   prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit der Zugriff auf diesen Datensatz nur durch den Berechtigten in Kenntnis des Secrets erfolgt.
   <span id="polarion-comment:287">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103604|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19172">
 </a>
 <dl>
  <dt>
   A_19172 - E-Rezept-Fachdienst - Löschung Secret und Status
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Zurückweisen eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$reject die externe ID in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier:Secret
   </span>
   als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/Secret" target="_top">
    https://gematik.de/fhir/Namingsystem/Secret
   </a>
   löschen und den Status des referenzierten Tasks auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = ready
   </span>
   setzen, damit nachfolgende Zugriffe auf diesen Datensatz durch Berechtigte in Kenntnis des AccessCodes erfolgen können.
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20458">
 6.1.2.5 POST /Task/&lt;id&gt;/$close
</h5>
<p id="polarion_98">
 Die FHIR-Operation $close beendet den E-Rezept-Workflow des unter der &lt;id&gt; geführten Tasks, erzeugt eine Quittung als Signatur über das vom abgebenden Leistungserbringer eingestellte MedicationDispense und speichert die vom Apotheker übermittelten Dispensierinformationen für den Versicherten. Diese Operation steht ausschließlich abgebenden Leistungserbringern in Kenntnis eines generierten Secrets zur Verfügung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103606|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19230">
 </a>
 <dl>
  <dt>
   A_19230 - E-Rezept-Fachdienst - Rollenprüfung Abgebender vollzieht Abgabe des Rezepts
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks für ein E-Rezept mittels HTTP-POST/$close-Operation auf den in der URL referenzierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   sicherstellen, dass ausschließlich abgebende Leistungserbringer in der Rolle
   <br/>
   <ul>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit der E-Rezept-Workflow nicht durch einen Unberechtigten abgeschlossen werden kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103607|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19231">
 </a>
 <dl>
  <dt>
   A_19231 - E-Rezept-Fachdienst - Prüfung Secret Rezept beenden
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks mittels HTTP-POST-Operation über /Task/&lt;id&gt;/$close das im URL-Parameter "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    ?secret=...
   </span>
   " übertragene Secret gegen das im referenzierten Task gespeicherte Secret
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier:Secret
   </span>
   als
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/Secret" target="_top">
    https://gematik.de/fhir/Namingsystem/Secret
   </a>
   und auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = in-progress
   </span>
   prüfen und bei Ungleichheit oder Fehlen des URL-Parameters die Operation mit dem HTTP-Fehlercode 403 abbrechen, damit der Zugriff auf diesen Datensatz nur durch den Berechtigten in Kenntnis des Secrets erfolgt.
   <span id="polarion-comment:288">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103608|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19248">
 </a>
 <dl>
  <dt>
   A_19248 - E-Rezept-Fachdienst - Schemaprüfung und Speicherung MedicationDispense
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks mittels /Task/&lt;id&gt;/$close das im http-Body des Requests enthaltene MedicationDispense-Objekt gegen das Profil
   <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxMedicationDispense" target="_top">
    https://gematik.de/fhir/StructureDefinition/erxMedicationDispense
   </a>
   prüfen und bei Gültigkeit die Rezept-ID
   <a class="descriptionLink" href="https://gematik.de/fhir/NamingSystem/PrescriptionID" target="_top">
    https://gematik.de/fhir/NamingSystem/PrescriptionID
   </a>
   als zusätzlichen
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    MedicationDispense.identifier
   </span>
   , die KVNR
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   des Versicherten aus dem referenzierten Task in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    MedicationDispense.subject:identifier
   </span>
   und die TelematikID der Apotheke gemäß ACCESS_TOKEN in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    MedicationDispense.performer.actor:identifier
   </span>
   sowie die Referenz auf den aufgerufenen Task
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;
   </span>
   als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    MedicationDispense.supportingInformation
   </span>
   übernehmen und die MedicationDispense für den Abruf durch den Versicherten speichern.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103609|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19232">
 </a>
 <dl>
  <dt>
   A_19232 - E-Rezept-Fachdienst - Status beenden
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die zulässige Beendigung eines Tasks mittels /Task/&lt;id&gt;/$close-Operation im Status
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status = completed
   </span>
   vollziehen, damit der Workflow für den Versicherten als beendet und das E-Rezept somit als eingelöst dargestellt wird.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-110769|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20513">
 </a>
 <dl>
  <dt>
   A_20513 - E-Rezept-Fachdienst - nicht mehr benötigte Einlösekommunikation
  </dt>
  <dd>
   Der
   <span id="polarion-comment:210">
   </span>
   E-Rezept-Fachdienst MUSS bei erfolgreicher Beendigung eines Tasks mittels /Task/&lt;id&gt;/$close-Operation alle Communication-Ressourcen löschen, die eine Referenz auf diesen Task in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.basedOn
   </span>
   enthalten, damit nicht mehr benötigte Informationen über die Kommunikation zur Einlösung des E-Rezepts vom E-Rezept-Fachdienst entfernt werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103610|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19233">
 </a>
 <dl>
  <dt>
   A_19233 - E-Rezept-Fachdienst - Serversignatur Rezept beenden (Quittung erstellen)
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Beenden eines Tasks mittels /Task/&lt;id&gt;/$close ein Quittungsbundle gemäß des FHIR-Profils
   <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxReceipt" target="_top">
    https://gematik.de/fhir/StructureDefinition/erxReceipt
   </a>
   erstellen, die Telematik-ID der diese Operation aufrufenden Apotheke als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Beneficiary
   </span>
   in die erxComposition übernehmen, dieses Quittungs-Bundle in XML-Darstellung gemäß
   <a class="descriptionLink" href="http://hl7.org/fhir/canonicalization/xml#static" target="_top">
    http://hl7.org/fhir/canonicalization/xml#static
   </a>
   kanonisieren und mit der Signaturidentität des Fachdienstes ID.FD.SIG gemäß [RFC5652] mit Profil CAdES-BES ([CAdES]) im Enveloping signieren, das Signatur-Ergebnis in der Codierung als
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    dss:Base64Signature
   </span>
   -Objekt in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Bundle.signature
   </span>
   einbetten und dieses Quittungs-Bundle mit Referenz in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.output
   </span>
   <span style="font-family: Arial, Helvetica;">
    mit Codingsystem
    <a class="descriptionLink" href="https://gematik.de/fhir/CodeSystem/Documenttype" target="_top">
     https://gematik.de/fhir/CodeSystem/Documenttype
    </a>
   </span>
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    = 3
   </span>
   speichern sowie als Response des http-Requests an den Aufrufer zurückgeben, damit der Apotheker einen Nachweis über den ordnungsgemäßen Abschluss des E-Rezept-Workflows als Quittung erhält.
   <span id="polarion-comment:267">
   </span>
  </dd>
 </dl>
</div>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20459">
 6.1.2.6 POST /Task/&lt;id&gt;/$abort
</h5>
<p id="polarion_153">
 Die FHIR-Operation $abort bricht einen unter der &lt;id&gt; angelegten Task als aktiven E-Rezept-Workflow ab und führt zum Löschen aller personenbezogenen und medizinischen Daten. Diese Operation steht
 <span style="font-size: 10pt;line-height: 1.5;">
  dem Versicherten, für den das E-Rezept erstellt wurde, sowie
 </span>
 allen Nutzern in Kenntnis des AccessCodes (verordnende und abgebende Leistungserbringer, Vertreter)  zur Verfügung.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103612|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19026">
 </a>
 <dl>
  <dt>
   A_19026 - E-Rezept-Fachdienst - Rollenprüfung Nutzer löscht Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   sicherstellen, dass ausschließlich Nutzer in der Rolle
   <br/>
   <ul>
    <li>
     oid_versicherter
    </li>
    <li>
     oid_arzt
    </li>
    <li>
     oid_zahnarzt
    </li>
    <li>
     oid_praxis_arzt
    </li>
    <li>
     oid_zahnarztpraxis
    </li>
    <li>
     oid_praxis_psychotherapeut
    </li>
    <li>
     oid_krankenhaus
    </li>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit E-Rezepte nicht durch Unberechtigte gelöscht werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103613|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19145">
 </a>
 <dl>
  <dt>
   A_19145 - E-Rezept-Fachdienst - Statusprüfung Apotheker löscht Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   verhindern und die Operation mit dem HTTP-Fehlercode 403 abweisen, wenn der Status des adressierten Tasks gleich "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    in-progress
   </span>
   " ist und die Rolle des aufrufenden Nutzers einer der folgenden Rollen entspricht:
   <br/>
   <ul>
    <li>
     oid_versicherter
    </li>
    <li>
     oid_arzt
    </li>
    <li>
     oid_zahnarzt
    </li>
    <li>
     oid_praxis_arzt
    </li>
    <li>
     oid_zahnarztpraxis
    </li>
    <li>
     oid_praxis_psychotherapeut
    </li>
    <li>
     oid_krankenhaus
    </li>
   </ul>
   damit Nutzer außerhalb der Apotheke keine Rezepte löschen, die sich aktuell in Belieferung befinden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103614|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19146">
 </a>
 <dl>
  <dt>
   A_19146 - E-Rezept-Fachdienst - Statusprüfung Nutzer (außerhalb Apotheke) löscht Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   verhindern und die Operation mit dem HTTP-Fehlercode 403 abweisen, wenn der Status des adressierten Tasks
   <span style="text-decoration: underline;">
    un
   </span>
   gleich "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    in-progress
   </span>
   " ist und die Rolle des aufrufenden Nutzers einer der folgenden Rollen entspricht:
   <br/>
   <ul>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   damit kein Apotheker ein Rezept löscht, das ihm nicht ausdrücklich zugewiesen wurde.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-110846|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20546">
 </a>
 <dl>
  <dt>
   A_20546 - E-Rezept-Fachdienst - Prüfung KVNR, Versicherter löscht Rezept
  </dt>
  <dd>
   <span style="font-size: 10pt;line-height: 1.5;">
    Der
    <span id="polarion-comment:204">
    </span>
    E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts durch einen Versicherten, wenn der HTTP-Request keinen HTTP-Header "
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     X-AccessCode
    </span>
    " enthält, den Versicherten anhand der KVNR aus dem ACCESS_TOKEN im "
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     Authorization
    </span>
    "-Header des HTTP-Requests identifizieren, diese gegen die in
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     Task.for
    </span>
    mit dem Value-Set
    <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
     http://fhir.de/NamingSystem/gkv/kvid-10
    </a>
    hinterlegte KVNR des begünstigten Patienten prüfen und bei Missmatch den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich der begünstigte Patient als Berechtigter ohne Kenntnis des AccessCodes ein E-Rezept löscht.
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-110845|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20547">
 </a>
 <dl>
  <dt>
   A_20547 - E-Rezept-Fachdienst - Prüfung KVNR, Vertreter löscht Rezept
  </dt>
  <dd>
   <span style="font-size: 10pt;line-height: 1.5;">
    Der
    <span id="polarion-comment:205">
    </span>
    E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts durch einen Versicherten, wenn der HTTP-Request einen HTTP-Header "
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     X-AccessCode
    </span>
    " enthält, diesen gegen den im referenzierten Task enthaltenen AccessCode prüfen und bei Missmatch den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich Vertreter in Kenntnis des AccessCodes als Berechtigte ein E-Rezept löschen.
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103615|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19120">
 </a>
 <dl>
  <dt>
   A_19120 - E-Rezept-Fachdienst - Prüfung AccessCode, Verordnender löscht Rezept
  </dt>
  <dd>
   Der
   <span id="polarion-comment:202">
   </span>
   E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   durch verordnende Leistungserbringer den im HTTP-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    X-AccessCode
   </span>
   " gegen den im referenzierten Task enthaltenen AccessCode prüfen und bei Missmatch oder Fehlen im HTTP-Header den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich die verordnende Leistungserbringerinstitution in Kenntnis des AccessCodes als Berechtigte ein E-Rezept löschen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103616|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19224">
 </a>
 <dl>
  <dt>
   A_19224 - E-Rezept-Fachdienst - Prüfung Secret, Apotheker  löscht Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   durch abgebende Leistungserbringer (Apotheken) das im URL-Parameter "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    ?secret=...
   </span>
   " übertragene Geheimnis gegen das im referenzierten Task enthaltene Secret in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.identifier
   </span>
   prüfen und bei Missmatch oder Fehlen des URL-Parameters den Aufruf mit dem HTTP-Fehlercode 403 abweisen, damit ausschließlich Apotheker in Kenntnis des Secret als Berechtigte ein E-Rezept löschen.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103617|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19027">
 </a>
 <dl>
  <dt>
   A_19027 - E-Rezept-Fachdienst - Rezept löschen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   alle personenbezogenen medizinischen Daten aus dem referenzierten Task entfernen. Dies gilt insbesondere für:
   <br/>
   <ul>
    <li>
     Task.for (KVNR des Patienten)--&gt; löschen
    </li>
    <li>
     Task.input --&gt; löschen (inkl. aller referenzierten Elemente)
    </li>
    <li>
     Task.output --&gt; löschen (inkl. aller referenzierten Elemente)
    </li>
    <li>
     Task.identifier (AccessCode) --&gt; löschen
    </li>
    <li>
     Task.identifier (Secret, falls vorhanden) --&gt; löschen
    </li>
    <li>
     MedicationDispense --&gt; die in MedicationDispense.supportingInformation auf Task.id verweist
    </li>
    <li>
     Communication --&gt; die in Communication.basedOn auf Task.id verweist
    </li>
   </ul>
   damit dem Betroffenenrecht auf Löschen durch den Versicherten entsprochen wird und beim Löschen durch den Verordnenden dem Versicherten eine aussagekräftige Fehlermeldung durch einen Apotheker vermittelt werden kann.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-103618|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19121">
 </a>
 <dl>
  <dt>
   A_19121 - E-Rezept-Fachdienst - Finaler Status cancelled
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Löschen eines E-Rezepts über den mittels der &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Task/&lt;id&gt;/$abort
   </span>
   den Status des Tasks
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Task.status
   </span>
   auf den Wert "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    cancelled
   </span>
   " setzen, damit das E-Rezept nicht weiter bearbeitet werden kann.
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20460">
 6.2 Ressource MedicationDispense
</h3>
<p id="polarion_50">
 Dem Versicherten werden über die Ressource MedicationDispense Informationen über ein eingelöstes E-Rezept bereitgestellt. Im MedicationDispense ist dabei die Referenz auf das abgegebene Medikament enthalten. Diese Informationen unterstützen den Versicherten im Versorgungsprozess, indem ihm bspw. mittels dieser Informationen ein digitaler Beipackzettel oder weitere Informationen wie Applikationsanleitungen zur Verfügung gestellt werden können. Der Zugriff auf die Ressource MedicationDispense erfolgt ausschließlich lesend über die http-GET-Operation. Das Löschen erfolgt indirekt über das Löschen des der MedicationDispense zugrunde liegenden Tasks.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104274|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19400">
 </a>
 <dl>
  <dt>
   A_19400 - E-Rezept-Fachdienst - unzulässige Operationen MedicationDispense
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource MedicationDispense mittels der HTTP-Operationen PUT, PATCH, HEAD und DELETE sowie POST unterbinden, damit keine unzulässigen Operationen auf den Rezeptdaten ausgeführt werden können.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20461">
 6.2.1 HTTP-Operation GET /MedicationDispense
</h4>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104281|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19405">
 </a>
 <dl>
  <dt>
   A_19405 - E-Rezept-Fachdienst - Rollenprüfung Versicherter liest MedicationDispense
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /MedicationDispense
   </span>
   und auf einen konkreten über &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /MedicationDispenses/&lt;id&gt;
   </span>
   sicherstellen, dass ausschließlich Versicherte in der Rolle
   <br/>
   <ul>
    <li>
     oid_versicherter
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit Dispensierinformationen nicht durch Unberechtigte ausgelesen werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104280|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19406">
 </a>
 <dl>
  <dt>
   A_19406 - E-Rezept-Fachdienst - Filter MedicationDispense auf KVNR des Versicherten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /MedicationDispense
   </span>
   die dem Versicherten zugeordneten MedicationDispense-Ressourcen anhand der KVNR des Versicherten im ACCESS_TOKEN im "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   "-Header des HTTP-Requests identifizieren, die in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    MedicationDispense.identifier
   </span>
   mit Codesystem
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   die entsprechende KVNR des begünstigten Patienten referenziert haben, damit ausschließlich Versicherte ihre eigenen Dispensierinformationen einsehen können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104493|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19518">
 </a>
 <dl>
  <dt>
   A_19518 - E-Rezept-Fachdienst - Suchparameter für MedicationDispense
  </dt>
  <dd>
   <span style="font-size: 10pt;line-height: 1.5;">
    Der E-Rezept-Fachdienst MUSS das Eingrenzen einer Suchanfrage auf
    <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
     /MedicationDispense
    </span>
    über die URL-Parameter gemäß
    <a class="descriptionLink" href="https://www.hl7.org/fhir/medicationdispense.html#search" target="_top">
     https://www.hl7.org/fhir/medicationdispense.html#search
    </a>
    für die Attribute MedicationDispense.whenHandedOver und MedicationDispense.performer.actor erlauben, damit Versicherte eine Suche und Sortierung nach Ausgabedatum sowie der aufgesuchten Apotheke durchführen können.
   </span>
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20462">
 6.3 Ressource Communication
</h3>
<p id="polarion_103">
 Der E-Rezept-Fachdienst ermöglicht eine direkte Kommunikation zwischen Versicherten und Apotheken über die Belieferung von E-Rezepten über den Endpunkt
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  &lt;Fachdienst-URL&gt;/Communication
 </span>
 gemäß der FHIR-Definition in
 <a class="descriptionLink" href="https://www.hl7.org/fhir/communication.html" target="_top">
  https://www.hl7.org/fhir/communication.html
 </a>
 .
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104272|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19401">
 </a>
 <dl>
  <dt>
   A_19401 - E-Rezept-Fachdienst - unzulässige Operationen Communication
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource Communication mittels der HTTP-Operationen PUT, PATCH und HEAD unterbinden, damit keine unzulässigen Operationen auf den Kommunikationsnachrichten ausgeführt werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104369|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19446">
 </a>
 <dl>
  <dt>
   A_19446 - E-Rezept-Fachdienst - Rollenprüfung Versicherter oder Apotheker liest Rezept
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET und POST-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   sicherstellen, dass ausschließlich Versicherte und Apotheken in der Rolle
   <br/>
   <ul>
    <li>
     oid_versicherter
    </li>
    <li>
     oid_oeffentliche_apotheke
    </li>
    <li>
     oid_krankenhausapotheke
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit der Nachrichtenaustausch nicht zwischen Unbefugten erfolgt.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20463">
 6.3.1 HTTP-Operation GET
</h4>
<p id="polarion_143">
 Die HTTP-Operation GET wird für den Nachrichtenabruf verwendet. Dabei werden alle Anfragen auf Basis der KVNR bzw. Telematik-ID im übergebenen ACCESS_TOKEN gefiltert, um die Nachrichten des jeweiligen Empfängers zu finden. Zusätzliche Filteranfragen für den Abruf ungelesener Nachrichten oder eine Sortierung nach Sendedatum sind zusätzlich möglich.
</p>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20464">
 6.3.1.1 GET /Communication/
</h5>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104499|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19520">
 </a>
 <dl>
  <dt>
   A_19520 - E-Rezept-Fachdienst - Nachrichten für Empfänger filtern
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Abrufen von Nachrichten über die http-Operation GET auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   bzw. beim Abruf einer einzelnen Nachricht über
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication/&lt;id&gt;
   </span>
   ausschließlich die Nachrichten an den Aufrufer zurückgeben, die im Attribut Communication.recipient oder
   <span style="font-size: 10pt;line-height: 1.5;">
    <span style="color: #333333;">
     Communication.sender
    </span>
   </span>
   mit dem entsprechenden NamingSystem
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/TelematikID" target="_top">
    https://gematik.de/fhir/Namingsystem/TelematikID
   </a>
   für Apotheken bzw.
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   für Versicherte den gleichen Typ und den identischen Wert haben wie im Attribut "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    idNummer"
   </span>
   des übergebenen ACCESS_TOKEN im HTTP-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " für KVNR bzw. Telematik-ID, damit keine Nachrichten an Dritte unrechtmäßig ausgelesen werden.
   <span id="polarion-comment:257">
   </span>
   <span id="polarion-comment:292">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104497|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19521">
 </a>
 <dl>
  <dt>
   A_19521 - E-Rezept-Fachdienst - Nachrichten als abgerufen markieren
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Abrufen von Nachrichten über die http-Operation GET auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   bzw. beim Abruf einer einzelnen Nachricht über
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication/&lt;id&gt;
   </span>
   den Wert des Attributs Communication.received = &lt;aktuelle Systemzeit&gt; setzen, wenn dieser Wert zum Zeitpunkt des Abrufs der Nachrichten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    NULL
   </span>
   ist, damit Nutzer eine Filtermöglicheit auf "neue Nachrichten" haben.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104498|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19522">
 </a>
 <dl>
  <dt>
   A_19522 - E-Rezept-Fachdienst - Nachrichtenabruf Suchparameter
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Eingrenzen einer Suchanfrage auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   über die URL-Parameter gemäß
   <a class="descriptionLink" href="https://www.hl7.org/fhir/communication.html#search" target="_top">
    https://www.hl7.org/fhir/communication.html#search
   </a>
   für die Attribut
   <span style="font-size: 10pt;line-height: 1.5;">
    e Communication.sent, Communication.received,
    <span style="color: #333333;">
     Communication.recipient und Communication.sender
    </span>
    erlauben, damit Versicherte eine Suche nach neuen Nachrichten, Sende- bzw. Empfangsrichtung und eine
   </span>
   Sortierung nach Sende- und Empfangsdatum durchführen können.
   <span id="polarion-comment:291">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-105607|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19534">
 </a>
 <dl>
  <dt>
   A_19534 - E-Rezept-Fachdienst - Rückgabe Communication im Bundle Paging
  </dt>
  <dd>
   Der E-Rezept-Fachdienst KANN beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   die Ergebnisliste der Communication-Ressourcen bei mehr als 50 Einträgen das Suchergebnis in einem Paging-Mechanismus auf mehrere Ergebnis-Bundle aufteilen, damit der Nutzer eine komfortable Navigationsmöglichkeit in seinen Nachrichten erhält.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20465">
 6.3.2 HTTP-Operation POST
</h4>
<p id="polarion_162">
 Mit der HTTP-Operation POST erfolgt der Versand einer Kommunikationsnachricht an eine Identität der Telematikinfrastruktur, welche über ihre systemweit eindeutige Identifikationsnummer Telematik-ID bzw. Versicherten-ID (10-stelliger Anteil der KVNR) adressiert wird.
</p>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20466">
 6.3.2.1 POST /Communication/
</h5>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104370|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19447">
 </a>
 <dl>
  <dt>
   A_19447 - E-Rezept-Fachdienst - Nachricht einstellen Schemaprüfung
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   die im http-Request-Body übergebene Communications-Ressource gegen das aus der Kommunikationsbeziehung ableitbare, zulässige Schema gemäß TAB_eRPFD_008
   <p class="polarion-rte-caption-paragraph" data-keep-next="true" style="text-align: left;">
    Tabelle
    <span class="polarion-rte-caption" data-sequence="Tabelle">
     #
    </span>
    : TAB_eRPFD_008 Nachrichtentyp zu Kommunikationsbeziehung
   </p>
   <table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
    <tbody>
     <tr>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       sender
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       recipient
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       zusätzliche Bedingung
      </th>
      <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Schema
      </th>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       KVNR
      </td>
      <td style="text-align: left;vertical-align: top;width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       TelematikID
      </td>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Communication.basedOn
       <br/>
       referenziert Task
      </td>
      <td style="text-align: left;vertical-align: top;width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxCommunicationDispReq" target="_top">
        https://gematik.de/fhir/StructureDefinition/erxCommunicationDispReq
       </a>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       KVNR
      </td>
      <td style="text-align: left;vertical-align: top;width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       TelematikID
      </td>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       Communication.about
       <br/>
       referenziert Medication
      </td>
      <td style="text-align: left;vertical-align: top;width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxCommunicationInfoReq" target="_top">
        https://gematik.de/fhir/StructureDefinition/erxCommunicationInfoReq
       </a>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       TelematikID
      </td>
      <td style="text-align: left;vertical-align: top;width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       KVNR
      </td>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       -
      </td>
      <td style="text-align: left;vertical-align: top;width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxCommunicationReply" target="_top">
        https://gematik.de/fhir/StructureDefinition/erxCommunicationReply
       </a>
      </td>
     </tr>
     <tr>
      <td style="text-align: left;vertical-align: top;width: 75px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       KVNR
      </td>
      <td style="text-align: left;vertical-align: top;width: 77px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       KVNR
      </td>
      <td style="text-align: left;vertical-align: top;width: 155px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       -
      </td>
      <td style="text-align: left;vertical-align: top;width: 402px;height: 19px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
       <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxCommunicationRepresentative" target="_top">
        https://gematik.de/fhir/StructureDefinition/erxCommunicationRepresentative
       </a>
      </td>
     </tr>
    </tbody>
   </table>
   <br/>
   prüfen und den Aufruf bei Nicht-Konformität mit dem http-Status-Code 400 ablehnen, damit ausschließlich konforme E-Rezept-Nachrichten ausgetauscht werden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104371|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19448">
 </a>
 <dl>
  <dt>
   A_19448 - E-Rezept-Fachdienst - Nachricht einstellen Absender und Sendedatum
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   die Absenderidentifikation aus dem Attribut "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    idNummer"
   </span>
   des übergebenen IDP-Token im HTTP-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " mit dem entsprechenden NamingSystem
   <a class="descriptionLink" href="https://gematik.de/fhir/Namingsystem/TelematikID" target="_top">
    https://gematik.de/fhir/Namingsystem/TelematikID
   </a>
   für Apotheken bzw.
   <a class="descriptionLink" href="http://fhir.de/NamingSystem/gkv/kvid-10" target="_top">
    http://fhir.de/NamingSystem/gkv/kvid-10
   </a>
   für Versicherte übernehmen sowie das Absendedatum
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.sent
   </span>
   auf die aktuelle Systemzeit des E-Rezept-Fachdienstes setzen, damit Absender und Sendezeitpunkt für den Empfänger eindeutig sind.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-109764|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20229">
 </a>
 <dl>
  <dt>
   A_20229 - E-Rezept-Fachdienst - Nachrichtenzähler bei Versicherter-zu-Versichertem-Kommunikation
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS die zulässige Anzahl der Communication-Ressourcen des Schemas
   <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxCommunicationRepresentative%A0" target="_top">
    https://gematik.de/fhir/StructureDefinition/erxCommunicationRepresentative
   </a>
   zur Versicherter-zu-Versichertem-Kommunikation auf einen konfigurierbaren Maximalwert (Default: 10) je referenziertem Task beschränken und bei Überschreiten des Maximalwerts das Einstellen einer Nachricht mit dem http-Status-Code 429 abbrechen, damit Versicherte den E-Rezept-Fachdienst nicht für beliebige Kommunikation außerhalb der Vertretung in der Einlösung von E-Rezepten benutzen.
   <span id="polarion-comment:212">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-110766|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20511">
 </a>
 <dl>
  <dt>
   A_20511 - E-Rezept-Fachdienst - Nachrichtenzähler zweckgebunden
  </dt>
  <dd>
   Der
   <span id="polarion-comment:211">
   </span>
   E-Rezept-Fachdienst DARF die Anzahl der Communication-Ressourcen je referenziertem Task für die Versicherter-zu-Versichertem-Kommunikation NICHT zu anderen Zwecken verwenden, als für die Beschränkung der Anzahl auf den maximalen Wert.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-109762|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20230">
 </a>
 <dl>
  <dt>
   A_20230 - E-Rezept-Fachdienst - Einlösbare E-Rezepte für Versicherter-zu-Versichertem-Kommunikation
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Einstellen einer Nachricht des Schemas
   <a class="descriptionLink" href="https://gematik.de/fhir/StructureDefinition/erxCommunicationRepresentative%A0" target="_top">
    https://gematik.de/fhir/StructureDefinition/erxCommunicationRepresentative
   </a>
   zur Versicherter-zu-Versichertem-Kommunikation über die http-Operation POST auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   mit dem http-Status-Code 400 abbrechen, wenn der referenzierte Task nicht im Zustand "ready" oder "in-progress" ist, damit die Weitergabe des Zugriffs auf E-Rezepte ausschließlich auf einlösbare bzw. in Arbeit befindliche Verordnungen beschränkt wird.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-109763|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20231">
 </a>
 <dl>
  <dt>
   A_20231 - E-Rezept-Fachdienst - Ausschluss Nachrichten an Empfänger gleich Absender
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   mit dem http-Status-Code 400 abbrechen, wenn der Empfänger
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.recipient
   </span>
   gleich der Absenderidentifikation im Attribut "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    idNummer"
   </span>
   des übergebenen IDP-Token im HTTP-Header "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   "  ist, damit irreführende Kommunikationsbeziehungen nicht zu einer vermeidbaren Mehrbelastung des E-Rezept-Fachdienstes führen.
   <span id="polarion-comment:258">
   </span>
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104373|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19450">
 </a>
 <dl>
  <dt>
   A_19450 - E-Rezept-Fachdienst - Nachricht einstellen Schadcodeprüfung
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   mit dem http-Status-Code 400 abbrechen, wenn der Nachrichteninhalt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.payload
   </span>
   größer als 10 kByte ist oder externe URLs enthält oder ein
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Attachment
   </span>
   mit MimeType "
   <span style="font-size: 11pt;font-family: 'Courier New', Courier, monospace, HanWangKanTan;color: #2B4180;line-height: 1.5;">
    application/*
   </span>
   " enthält, damit über den E-Rezept-Fachdienst kein Schadcode verteilt wird.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112651|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20885">
 </a>
 <dl>
  <dt>
   A_20885 - E-Rezept-Fachdienst - Nachricht einstellen Prüfung Versichertenbezug und Berechtigung
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS das Einstellen einer Nachricht über die http-Operation POST auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication
   </span>
   mit dem http-Status-Code 400 abbrechen, wenn der Wert
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.basedOn
   </span>
   einen Task referenziert und dabei die KVNR des referenzierten Tasks Task.for ungleich der KVNR des Einstellenden in "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    idNummer"
   </span>
   des übergebenen ACCESS_TOKEN und auch der AccessCode der Task-Referenz ungleich dem AccessCode in Task.identifier ist, um irreführende Testnachrichten zu unterbinden, die eine vermeidbare Mehrbelastung für den E-Rezept-Fachdienst darstellen.
   <span id="polarion-comment:293">
   </span>
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20467">
 6.3.3 HTTP-Operation DELETE
</h4>
<p id="polarion_119">
 Mit der HTTP-Operation DELETE kann ein Nutzer eine verschickte Kommunikationsnachricht als Absender löschen, um bspw. einen Irrläufer zurückzurufen. Der E-Rezept-Fachdienst prüft, ob die Nachricht bereits abgerufen wurde. Das Löschen einer ungelesenen Nachricht erfolgt sofort, das Löschen einer bereits abgerufenen Nachricht wird vom E-Rezept-Fachdienst abgelehnt, um darauf hinzuweisen, dass die Nachricht als Kopie im Clientsystem des Empfängers vorliegt und das Löschen nicht vor unberechtigter Einsichtnahme schützt.
</p>
<p id="polarion_126">
 Um den Schutz vor unberechtigter Einsichtnahme in persönliche Daten durchzusetzen, ist es ratsam bei bereits gelesenen Nachrichten den referenzierten E-Rezept-Task zu löschen. Für eine geeignete Nutzerführung auf Clientseite ergänzt der E-Rezept-Fachdienst die http-Response um das Header-Attribut "Warning" mit einem entsprechenden Hinweis. Das Löschen des Task führt direkt auch zum Löschen aller Kommunikationsnachrichten, die auf diesen Task verweisen. Damit kann ein fälschlich adressierter Vertreter eines Versicherten keine Einsicht in die Daten des E-Rezepts mehr nehmen bzw. das E-Rezept in keiner Apotheke mehr einlösen.
</p>
<h5 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20468">
 6.3.3.1 DELETE /Communication/
</h5>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-110234|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20258">
 </a>
 <dl>
  <dt>
   A_20258 - E-Rezept-Fachdienst - Communication löschen auf Basis Absender-ID
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-DELETE-Operation auf
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /Communication/&lt;id&gt;
   </span>
   die über &lt;id&gt; identifizierte Communication-Ressource anhand der KVNR bzw. Telematik-ID des aufrufenden Nutzers im ACCESS_TOKEN im "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   "-Header des HTTP-Requests über das Absender-Attribut
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.sender
   </span>
   lokalisieren und löschen, damit Nutzer irrtümlich versendete oder nicht mehr gewünschte Nachrichten vom E-Rezept-Fachdienst entfernen können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-110235|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20259">
 </a>
 <dl>
  <dt>
   A_20259 - E-Rezept-Fachdienst - Communication löschen mit Warnung wenn vom Empfänger bereits abgerufen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Löschen einer Communication-Ressource der http-Response das http-Header-Feld "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Warning
   </span>
   " mit dem Zeitpunkt des Nachrichtenabrufs durch den Empfänger ergänzen (z.B. "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Warning: 'Deleted message delivered at 2020-07-01 10:30:00'
   </span>
   "), wenn die Nachricht bereits durch den Empfänger abgerufen wurde (
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Communication.received
   </span>
   ungleich NULL, bzw. enthält Datum des Abrufs), um dem Absender einen Hinweis anzeigen zu können.
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20469">
 6.4 Ressource AuditEvent
</h3>
<p id="polarion_19">
 Der E-Rezept-Fachdienst protokolliert alle Zugriffe auf personenbezogene und medizinische Daten der E-Rezepte von Versicherten. Über den Endpunkt
 <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
  &lt;Fachdienst-URL&gt;/AuditEvent
 </span>
 stehen diese für den Abruf durch den jeweils betroffenen Versicherten zur Verfügung. Die Protokolleinträge werden gemäß der Löschfrist im E-Rezept-Fachdienst  gespeichert und nach Ablauf dieser Frist automatisch gelöscht.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104273|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19402">
 </a>
 <dl>
  <dt>
   A_19402 - E-Rezept-Fachdienst - unzulässige Operationen AuditEvent
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS alle Zugriffe auf die Ressource AuditEvent mittels der HTTP-Operationen PUT, PATCH, HEAD, DELETE und POST unterbinden, damit keine unzulässigen Operationen auf den Protokolldaten ausgeführt werden können.
  </dd>
 </dl>
</div>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20470">
 6.4.1 HTTP-Operation GET /AuditEvent
</h4>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104267|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19395">
 </a>
 <dl>
  <dt>
   A_19395 - E-Rezept-Fachdienst - Rollenprüfung Versicherter liest AuditEvent
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /AuditEvent
   </span>
   und auf einen konkreten über &lt;id&gt; adressierten
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /AuditEvent/&lt;id&gt;
   </span>
   sicherstellen, dass ausschließlich Versicherte in der Rolle
   <br/>
   <ul>
    <li>
     oid_versicherter
    </li>
   </ul>
   die Operation am Fachdienst aufrufen dürfen und die Rolle "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    professionOID
   </span>
   " des Aufrufers im ACCESS_TOKEN im HTTP-RequestHeader "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   " feststellen, damit E-Rezept-Protokolleinträge nicht durch Unberechtigte ausgelesen werden können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104265|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19396">
 </a>
 <dl>
  <dt>
   A_19396 - E-Rezept-Fachdienst - Filter AuditEvent auf KVNR des Versicherten
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /AuditEvent
   </span>
   die dem Versicherten zugeordneten AuditEvent-Ressourcen anhand der KVNR des Versicherten im ACCESS_TOKEN im "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    Authorization
   </span>
   "-Header des HTTP-Requests identifizieren, die in
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    AuditEvent.entity.name
   </span>
   die entsprechende KVNR des begünstigten Patienten referenziert haben, damit ausschließlich Versicherte ihre eigenen E-Rezept-Protokolleinträge einsehen können.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104270|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19399">
 </a>
 <dl>
  <dt>
   A_19399 - E-Rezept-Fachdienst - Suchparameter AuditEvent
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /AuditEvent
   </span>
   eine Sortierung über die Attribute der Protokolleinträge "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    date
   </span>
   ", "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    agent
   </span>
   " und "
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    subType
   </span>
   " gemäß der Festlegungen für die Ressource AuditEvent
   <a class="descriptionLink" href="https://www.hl7.org/fhir/auditevent.html#search" target="_top">
    https://www.hl7.org/fhir/auditevent.html#search
   </a>
   in den URL-Parametern zulassen, damit sich Versicherte in ihrem Zugriffsprotokoll besser zurecht finden.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104266|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19397">
 </a>
 <dl>
  <dt>
   A_19397 - E-Rezept-Fachdienst - Rückgabe AuditEvents im Bundle
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /AuditEvent
   </span>
   die Ergebnisliste der AuditEvent-Ressourcen bei mehr als einem Eintrag als Ergebnis-Bundle an den Aufrufer zurückgeben, damit der Versicherte eine vollständige Einsicht in das Zugriffsprotokoll erhält.
  </dd>
 </dl>
</div>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-104268|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_19398">
 </a>
 <dl>
  <dt>
   A_19398 - E-Rezept-Fachdienst - Rückgabe AuditEvents im Bundle Paging
  </dt>
  <dd>
   Der E-Rezept-Fachdienst KANN beim Aufruf der HTTP-GET-Operation auf den Endpunkt
   <span style="font-family: 'Courier New', Courier, monospace, HanWangKanTan;">
    /AuditEvent
   </span>
   die Ergebnisliste der AuditEvent-Ressourcen bei mehr als 50 Einträgen das Suchergebnis in einem Paging-Mechanismus auf mehrere Ergebnis-Bundle aufteilen, damit der Versicherte eine komfortable Navigationsmöglichkeit in seinem Zugriffprotokoll erhält.
  </dd>
 </dl>
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20471">
 6.5 Ressource Device
</h3>
<p id="polarion_70">
</p>
<p id="polarion_117">
 Gemäß CapabilityStatement und FHIR-Profilierung stellt der E-Rezept-Fachdienst statische Informationen über seine Produkttypversion zur Verfügung. Mit diesen erhalten Clients eine entsprechende Auskunft und bei Bedarf das Signaturzertifikat C.FD.SIG für die Signaturprüfung, für welches der E-Rezept-Fachdienst serverseitige Signaturen für die E-Rezept-Quittung und den E-Rezept-Datensatz für Versicherte erstellt.
</p>
<div id="polarion_wiki macro name=module-workitem;params=id=ML-112023|project=Mainline_OPB1|external=true|revision=295337">
 <a name="A_20744">
 </a>
 <dl>
  <dt>
   A_20744 - E-Rezept-Fachdienst - Selbstauskunft Device-Informationen
  </dt>
  <dd>
   Der E-Rezept-Fachdienst MUSS über die http-Operation GET /Device dem aufrufenden Clientsystem eine statische Auskunft gemäß der Profilierung der Device-Ressource bereitstellen.
  </dd>
 </dl>
</div>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20472">
 7 Informationsmodell
</h2>
<p id="polarion_52">
 Der E-Rezept-Fachdienst verwaltet E-Rezepte mittels der HL7-FHIR-Workflow-Ressource Task. Die Statusübergänge im Task werden durch verschiedene FHIR-Operationen der Ressource Task getriggert. Als Payload eines Tasks werden verschiedene E-Rezept-Bundles als Nutzdaten transportiert bzw. fachdienstseitig erzeugt.
</p>
<ul id="polarion_56">
 <li>
  E-Rezept-Bundle, enveloping in QES-Datensatz enthalten (Task.input),
  <br/>
  Enthält die eigentlichen Verordnungsdaten, inkl. qualifizierter elektronischer Signatur des Arztes bzw. Zahnarztes
 </li>
 <li>
  Kopie des E-Rezept-Bundles (Task.input),
  <br/>
  Kopie der Verordnungsdaten für die Einsicht durch den Versicherten, inkl. serverseitiger Signatur
 </li>
 <li>
  Quittungs-Bundle (Task.output),
  <br/>
  Zusammenstellung aus QES-signierten Verordnungsdaten und Workflowdaten, inkl. serverseitiger Signatur
 </li>
</ul>
<p id="polarion_57">
 Für die Nachvollziehbarkeit der Medikamentenabgabe an den Versicherten erwartet der E-Rezept-Fachdienst zum Abschluss des Workflows die Übergabe einer MedicationDispense-Ressource von der abgebenden Leistungserbringerinstitution (Apotheke), die das abgegebene Medikament in einer Medication-Ressource dokumentiert. Die Verbindung zwischen MedicationDispense und Task erfolgt über MedicationDispense.supportingInformation.
</p>
<p id="polarion_96">
 Über den Zugriff auf personenbezogene medizinische Daten des Tasks und der MedicationDispenses führt der E-Rezept-Fachdienst ein Zugriffsprotokoll mittels der Ressource AuditEvent zum Abruf durch den Versicherten. Das Attribut AuditEvent.entity speichert dabei die Referenz des betroffenen Datenobjekts und die KVNR des Versicherten.
</p>
<p id="polarion_88">
 Über die Ressource Communication steht Versicherten und Apotheken ein Nachrichtenaustausch zur Verfügung. Communication-Einträge können dabei vom Versicherten eingestellt an Apotheken adressiert werden, Apotheken können Communication-Einträge für Versicherte bereitstellen. Mit der Communication-Ressource stellt der E-Rezept-Fachdienst keine vollwertige Messenger-Plattform zur Verfügung. Nachrichten von Versicherten an Versicherte sind im begrenzten Rahmen (Referenz eines Tasks und maximale Anzahl Nachrichten zu einem Task) zulässig, die Größe transportierbarer Communications-Einträge ist bewusst auf wenige Kilobytes begrenzt, um den Transport von Schadcode zu erschweren und den Nachrichtenaustausch auf die Belieferung von E-Rezepten zu beschränken. Um verschiedene Kommunikationsbeziehungen [Versicherter - Apotheke, Apotheke - Versicherter, Versicherter - Versicherter] abzubilden, werden dezidierte Profile für die Communication-Ressource definiert. Mit diesen Profilen werden Nachrichtentypen realisiert, um die jeweiligen Restriktionen für Verfügbarkeitsanfrage, Einlöseauftrag und Vertreterkommunikation abzubilden.
</p>
<p id="polarion_106">
 Der E-Rezept-Fachdienst speichert und verwaltet keine Patient-, Practitioner und Organization-Ressourcen. Sämtliche Bezüge zu verordnenden und abgebenden Leistungserbringern, Praxen und Apotheken sowie Versicherten erfolgen über logische Referenzen. Somit wird der Aufbau einer zentralen Patienten-Kartei und Liste verordnender Ärzte im E-Rezept-Fachdienst unnötig. Zudem löscht der E-Rezept-Fachdienst regelmäßig veraltete Daten, um die Verfügbarkeit der für den Workflow notwendigen Daten auf ein Minimum zu beschränken.
</p>
<p id="polarion_81">
 Der E-Rezept-Fachdienst startet einen E-Rezept-Workflow ausschließlich bei einer gültigen Verordnung, das heißt, das E-Rezept-Bundle muss über eine gültige QES eines zur Verordnung berechtigten Leistungserbringers verfügen. Zudem wird die Patientenreferenz (KVNR) aus genau diesem Datensatz verwendet, um dem Patienten, dem diese Verordnung gemäß ärztlicher Signatur gilt, die Hoheit über das E-Rezept einzuräumen.
</p>
<p id="polarion_87">
 Die nachfolgende Abbildung gibt eine Übersicht der verwalteten FHIR-Ressourcen.
 <span style="background-color: #FF0000;">
 </span>
</p>
<p class="polarion-rte-caption-paragraph" id="polarion_36" style="text-align: center;">
 <img data-lastmodified="2020-06-02T13:55:58.839+02:00" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAACWBAMAAACWdajhAAAAG1BMVEV//9QAAABv37kPHxo/f2ovX09Pn4Rfv58fPzUApD1aAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACZklEQVR4nO2WQW/TQBCFF8dNOHa7tevjBoi4xoVWHGP10mNopZ6dnDgG+AM1SPC3mfGu7Vlhh4SmIkjvk9pmZ948P3lXmyoFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8x0Rm/07LdH7QLFsf/vm0t9OUJTvF6ht8eqzm0X8ViwXh4I4v+I+buM1np1h7jhxRrOn8xiyVmtybO1rN8qyMTJxfBU0e7DpjrfXc+00v780irjKruPe+kV7xekbrW/1N+YLzqoeFaFyljV0Y653WiVIrrY1VE5Kkkcm1Xsom2YhOEIs+Zzmv695jI71QEf3W38lV+YLzamJ5kan0QCyzHmsb6btJRU9J7Nsfkb62qzPRrJ8vOs1b57JZxzqxX1OKcf1qlXLtdWJnGa9tQa556QudlxSldmATL5X6WMb0TkYXqnhUfIKsOklFkwdlR8YiQb5R8Xl97uKsltKbrixryVEVC1/ovELR0Nni0ZdkQN7VRrmDTZ+7Jv+RHRmLPlJrnNQ9+mEpPaooec2uq6UvdF6haFusEW0aeed2KJbsDMZSupbyqVqIWK4QxupEzx8rOnSsw2ziJGv2x2nFJkqvULQtFh1WceR7YsnOi9OBWCd1ZBoIY7mC9+LhQNTa9cQSF8RDbyzZGZ33xlpHxZmTfok+bUQsV/BePByIWrueWP46HbtLsyeW7MTiOu1i8WEpm+tUy1iu4L3i7jp1otauL1b75fOh7I0VdOpvpN/e1o3+6Sbe5OZBbqIreC8eDkSt3bOww7+I/wLE2ocjjQUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAx8Yv0dGgYPUMKHsAAAAASUVORK5CYII=" style="max-width: 750px;"/>
</p>
<p class="polarion-rte-caption-paragraph" id="polarion_140" style="text-align: center;">
 Abbildung
 <span class="polarion-rte-caption" data-sequence="Abbildung">
  #
 </span>
 :  Informationsmodell FHIR-Ressourcen E-Rezept-Fachdienst
</p>
<h2 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20473">
 8 Anhang A – Verzeichnisse
</h2>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20474">
 8.1 Abkürzungen
</h3>
<table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=1" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
 <tbody>
  <tr>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 120px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">
    Kürzel
    <br/>
   </th>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 611px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">
    Erläuterung
    <br/>
   </th>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">
    AVS
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Apothekenverwaltungssystem
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    FdV
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Frontend des Versicherten
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    FHIR
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Fast Healthcare Interoperable Resources
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    FQDN
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 18px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Fully Qualified Domain Name
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    HSM
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Hardware Security Module
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    KVNR
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Krankenversichertennummer
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    LEI
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Leistungserbringerinstitution
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    OCSP
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Online Certificate Status Protocol
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    OWASP
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Open Web Application Security Project
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    PVS
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Praxisverwaltungssystem
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    QES
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Qualifizierte Elektronische Signatur
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    SLA
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Service Level Agreement
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    SMC-B
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    Security Module Card Typ B, Institutionenkarte
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    TI
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">
    Telematikinfrastruktur
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    TLS
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">
    Transport Layer Security
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    TSL
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">
    Trust Service Status List
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 120px;height: 20.4px;border: 1px solid #CCCCCC;border-top: 1px solid #CCCCCC;border-bottom: 1px solid #CCCCCC;border-right: 1px solid #CCCCCC;border-left: 1px solid #CCCCCC;padding: 5px;">
    VAU
   </td>
   <td style="text-align: left;vertical-align: top;width: 611px;height: 20.4px;border: 1px solid #CCCCCC;padding: 5px;">
    Vertrauenswürdige Ausführungsumgebung
   </td>
  </tr>
 </tbody>
</table>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20475">
 8.2 Glossar
</h3>
<table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=2" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
 <tbody>
  <tr>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 154px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">
    Begriff
    <br/>
   </th>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 426.8px;height: 19.6px;border: 1px solid #CCCCCC;padding: 5px;">
    Erläuterung
    <br/>
   </th>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 154px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">
    Funktionsmerkmal
   </td>
   <td style="text-align: left;vertical-align: top;width: 426.8px;height: 57.2px;border: 1px solid #CCCCCC;padding: 5px;">
    Der Begriff beschreibt eine Funktion oder auch einzelne, eine logische Einheit bildende Teilfunktionen der TI im Rahmen der funktionalen Zerlegung des Systems.
   </td>
  </tr>
 </tbody>
</table>
<p id="polarion_181">
 Das Glossar wird als eigenständiges Dokument (vgl. [gemGlossar]) zur Verfügung gestellt.
</p>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20476">
 8.3 Abbildungsverzeichnis
</h3>
<div data-sequence="Abbildung" id="polarion_wiki macro name=tof;params=uid=1">
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20477">
 8.4 Tabellenverzeichnis
</h3>
<div data-sequence="Tabelle" id="polarion_wiki macro name=tof;params=uid=2">
</div>
<h3 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20478">
 8.5 Referenzierte Dokumente
</h3>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20479">
 8.5.1 Dokumente der gematik
</h4>
<p id="polarion_186">
 Die nachfolgende Tabelle enthält die Bezeichnung der in dem vorliegenden Dokument referenzierten Dokumente der gematik zur Telematikinfrastruktur. Der mit der vorliegenden Version korrelierende Entwicklungsstand dieser Konzepte und Spezifikationen wird pro Release in einer Dokumentenlandkarte definiert; Version und Stand der referenzierten Dokumente sind daher in der nachfolgenden Tabelle nicht aufgeführt. Deren zu diesem Dokument jeweils gültige Versionsnummern sind in der aktuellen, von der gematik veröffentlichten Dokumentenlandkarte enthalten, in der die vorliegende Version aufgeführt wird.
</p>
<p id="polarion_187">
</p>
<table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=4" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
 <tbody>
  <tr>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [Quelle]
    <br/>
   </th>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Herausgeber: Titel
    <br/>
   </th>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">
    [gemGlossar]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 38px;border: 1px solid #CCCCCC;padding: 5px;">
    gematik: Glossar der Telematikinfrastruktur
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [gemSpec_IDP_FD]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Spezifikation Identity Provider – Nutzungsspezifikation  für Fachdienste
   </td>
  </tr>
 </tbody>
</table>
<h4 id="polarion_wiki macro name=module-workitem;params=id=OPB401-20480">
 8.5.2 Weitere Dokumente
</h4>
<table class="polarion-Document-table" id="polarion_wiki macro name=table;params=width=100%|uid=5" style="width: 100%;margin-left: auto;margin-right: auto;border: 1px solid #CCCCCC;empty-cells: show;border-collapse: collapse;">
 <tbody>
  <tr>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [Quelle]
    <br/>
   </th>
   <th style="font-weight: bold;background-color: #F0F0F0;text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Herausgeber (Erscheinungsdatum): Titel
    <br/>
   </th>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [rfc6902]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Definition JSON Patch-Operation
    <br/>
    <a class="descriptionLink" href="https://tools.ietf.org/html/rfc6902" target="_top">
     https://tools.ietf.org/html/rfc6902
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [ETSI_QES]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    DEN/ESI-0019122 Electronic Signatures and Infrastructures (ESI); CAdES digital signatures
    <br/>
    ETSI EN 319 102-1 Procedures for Creation and Validation of AdES Digital Signatures
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [RFC5652]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    <span style="font-size: 10pt;line-height: 1.5;">
     Cryptographic Message Syntax (CMS), RFC 5652 (September 2009)
    </span>
    <br/>
    <a class="descriptionLink" href="http://tools.ietf.org/html/rfc5652" target="_blank">
     http://tools.ietf.org/html/rfc5652
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [CAdES]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    <span style="font-size: 10pt;line-height: 1.5;">
     ETSI: Electronic Signature Formats, Electronic Signatures and Infrastructures (ESI) – Technical Specification, ETSI TS 101 733 V2.2.1, via
    </span>
    <a class="descriptionLink" href="http://www.etsi.org" target="_blank">
     http://www.etsi.org
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [FHIR-Sig]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    FHIR - Signature (JSON Signature rules for FHIR Resources)
    <br/>
    <a class="descriptionLink" href="https://www.hl7.org/fhir/datatypes.html#Signature" target="_top">
     https://www.hl7.org/fhir/datatypes.html#Signature
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [FHIR-TASK]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    FHIR Ressource Task
    <br/>
    <a class="descriptionLink" href="https://www.hl7.org/fhir/task.html" target="_top">
     https://www.hl7.org/fhir/task.html
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [FHIR-ResVers]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    FHIR Policy für RessourcenVersionierung
    <br/>
    <a class="descriptionLink" href="https://www.hl7.org/fhir/valueset-versioning-policy.html" target="_top">
     https://www.hl7.org/fhir/valueset-versioning-policy.html
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [HTTP-STATUS-CODES]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    HTTP-StatusCode gemäß RFC-2616
    <br/>
    <a class="descriptionLink" href="https://tools.ietf.org/html/rfc2616" target="_top">
     https://tools.ietf.org/html/rfc2616
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [JWT]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    JSON Web Token (JWT)
    <br/>
    <a class="descriptionLink" href="https://tools.ietf.org/html/rfc7519" target="_top">
     https://tools.ietf.org/html/rfc7519
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [JWS]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    JSON Web Signature (JWS)
    <br/>
    <a class="descriptionLink" href="https://tools.ietf.org/html/rfc7515" target="_top">
     https://tools.ietf.org/html/rfc7515
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [DAL_ANDROID]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Asset Owners Guide -
    <span style="font-size: 10pt;line-height: 1.5;">
     <span style="color: #202124;">
      Use statements to enable App Linking, declare default app handlers, ...
     </span>
    </span>
    <br/>
    <a class="descriptionLink" href="https://developers.google.com/digital-asset-links/v1/getting-started" target="_top">
     https://developers.google.com/digital-asset-links/v1/getting-started
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [RFC7231]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content
    <br/>
    <a class="descriptionLink" href="https://tools.ietf.org/html/rfc7231" target="_top">
     https://tools.ietf.org/html/rfc7231
    </a>
   </td>
  </tr>
  <tr>
   <td style="text-align: left;vertical-align: top;width: 148px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    [UL_APPLE]
   </td>
   <td style="text-align: left;vertical-align: top;width: 599px;height: 19px;border: 1px solid #CCCCCC;padding: 5px;">
    Allowing Apps and Websites to Link to Your Content
    <br/>
    <a class="descriptionLink" href="https://developer.apple.com/documentation/uikit/inter-process_communication/allowing_apps_and_websites_to_link_to_your_content" target="_top">
     https://developer.apple.com/documentation/uikit/inter-process_communication/allowing_apps_and_websites_to_link_to_your_content
    </a>
   </td>
  </tr>
 </tbody>
</table>
<p id="polarion_161">
 <br/>
</p>

</div>
</body>
</html>